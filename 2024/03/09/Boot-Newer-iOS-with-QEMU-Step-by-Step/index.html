<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Boot Newer iOS with QEMU Step by Step | </title><meta name="keywords" content="iOS,QEMU,Security"><meta name="author" content="KpwnZ"><meta name="copyright" content="KpwnZ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Boot Newer iOS with QEMU Step by Step I decided to update my QEMU fork to support newer iOS versions for security research and some CTFs. Just note down how I did it here. First attempt Build D22-QEMU">
<meta property="og:type" content="article">
<meta property="og:title" content="Boot Newer iOS with QEMU Step by Step">
<meta property="og:url" content="https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/index.html">
<meta property="og:site_name">
<meta property="og:description" content="Boot Newer iOS with QEMU Step by Step I decided to update my QEMU fork to support newer iOS versions for security research and some CTFs. Just note down how I did it here. First attempt Build D22-QEMU">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://source.unsplash.com/featured/?landscape,tech,life">
<meta property="article:published_time" content="2024-03-09T18:30:27.000Z">
<meta property="article:modified_time" content="2024-03-12T03:20:53.626Z">
<meta property="article:author" content="KpwnZ">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="QEMU">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://source.unsplash.com/featured/?landscape,tech,life"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Boot Newer iOS with QEMU Step by Step',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-11 20:20:53'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/22996989?s=400&amp;u=470b81ce0dd0fd2e15880f564e1bef0ba9655225&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">18</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">19</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://source.unsplash.com/featured/?landscape,tech,life')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/"></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Boot Newer iOS with QEMU Step by Step</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-03-09T18:30:27.000Z" title="Created 2024-03-09 10:30:27">2024-03-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-03-12T03:20:53.626Z" title="Updated 2024-03-11 20:20:53">2024-03-11</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Boot Newer iOS with QEMU Step by Step"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>Boot Newer iOS with QEMU Step by Step</h1>
<p>I decided to update <a target="_blank" rel="noopener" href="https://github.com/KpwnZ/d22-qemu">my QEMU fork</a> to support newer iOS versions for security research and <s>some CTFs</s>. Just note down how I did it here.</p>
<h2 id="First-attempt">First attempt</h2>
<p>Build D22-QEMU and load the iOS 14 kernel and we got</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">./qemu-system-aarch64 -M d22-idevice,kernelcache=&#x27;ios14/kcache.patched&#x27;,devicetree=&#x27;ios14/dtre.bin&#x27;,ramdisk=&#x27;ios14/rdsk.dmg&#x27;,trustcache=&#x27;ios14/trustcache&#x27;,bootargs=&#x27;debug=0x14e kextlog=0xffff cpus=1 rd=md0 serial=2&#x27;,ram-size=&#x27;1073741824&#x27; \</span><br><span class="line">-d unimp,int -cpu max -serial mon:stdio -D ./qemu.log</span><br><span class="line">iBoot version: D22-QEMU loader</span><br><span class="line">Darwin Image4 Validator Version 3.1.0: Fri Oct 30 00:14:28 PDT 2020; root:AppleImage4-106.40.12~2113/AppleImage4/RELEASE_ARM64</span><br><span class="line">panic(cpu 0 caller 0xfffffff0080af660): Kernel data abort. at pc 0xfffffff008024f64, lr 0xfffffff008024f54 (saved state: 0xffffffe80260b5f0)</span><br><span class="line">	  x0: 0xffffffe4cddbcbf0  x1:  0xfffffff00932cbe8  x2:  0x0000000000000000  x3:  0xffffffe80260b960</span><br><span class="line">	  x4: 0x0000000000000007  x5:  0x0000000000000073  x6:  0x829f5c9941fe80a8  x7:  0x0000000000000630</span><br><span class="line">	  x8: 0x0000000000000000  x9:  0xfffffff00774ada8  x10: 0xfffffff00774adb8  x11: 0x0000000000000001</span><br><span class="line">	  x12: 0x00000000004a0000 x13: 0x00000000ffdfffff  x14: 0x0000000000000001  x15: 0x0003ffffff933789</span><br><span class="line">	  x16: 0x0000000000004000 x17: 0xfffffff0073ac824  x18: 0xfffffff0080a1000  x19: 0xffffffe4cde8ba00</span><br><span class="line">	  x20: 0xffffffe4cdf70680 x21: 0x0000000000000000  x22: 0xffffffe80260bab0  x23: 0x0000000000000009</span><br><span class="line">	  x24: 0xfffffff0081bdee8 x25: 0xfffffff009300de8  x26: 0x0000000000000009  x27: 0x0000000000000009</span><br><span class="line">	  x28: 0xfffffff009300de8 fp:  0xffffffe80260b9c0  lr:  0xfffffff008024f54  sp:  0xffffffe80260b940</span><br><span class="line">	  pc:  0xfffffff008024f64 cpsr: 0x60400204         esr: 0x96000005          far: 0x0000000000000000</span><br></pre></td></tr></table></figure>
<p>Well although it paniked, it’s a good start at least the serial port is still working. Then let’s check the pc address</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__text:FFFFFFF008024F64 loc_FFFFFFF008024F64                    ; CODE XREF: sub_FFFFFFF008024D88+26C↓j</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F64                                         ; sub_FFFFFFF008024D88+278↓j ...</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F64                 LDR             X8, [X21] ; Load from Memory</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F68                 LDR             X8, [X8,#0x138] ; Load from Memory</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F6C                 MOV             X0, X21 ; Rd = Op2</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F70                 MOV             X1, X20 ; Rd = Op2</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F74                 BLR             X8      ; Branch and Link Register</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F78                 MOV             X20, X0 ; Rd = Op2</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F7C                 CBZ             X0, loc_FFFFFFF008024F90 ; Compare and Branch on Zero</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F80                 LDR             X8, [X20] ; Load from Memory</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F84                 LDR             X8, [X8,#0x20] ; Load from Memory</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F88                 MOV             X0, X20 ; Rd = Op2</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F8C                 BLR             X8      ; Branch and Link Register</span><br></pre></td></tr></table></figure>
<p>After some reversing, I found that that it’s nvram variable loading routine. But we didn’t load any nvram variable! In iOS 14, nvram data can be loaded to devicetree by iBoot</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">result = sub_FFFFFFF007FCE6F8(<span class="string">&quot;/chosen&quot;</span>, qword_FFFFFFF009301760, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line"><span class="keyword">if</span> ( result )</span><br><span class="line">&#123;</span><br><span class="line">  v3 = result;</span><br><span class="line">  v4 = (*(__int64 (__fastcall **)(__int64, <span class="keyword">const</span> <span class="keyword">char</span> *))(*(_QWORD *)result + <span class="number">328LL</span>))(result, <span class="string">&quot;nvram-proxy-data&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>I am just too lazy to reverse the nvram stuff, but since it’s loaded to devicetree, we can dump it from a real device! Now let’s try to find the memory address of devicetree. Luckily, we have</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">xnu_boot_args</span> &#123;</span></span><br><span class="line">	<span class="keyword">uint16_t</span>                Revision;                       <span class="comment">/* Revision of boot_args structure */</span></span><br><span class="line">	<span class="keyword">uint16_t</span>                Version;                        <span class="comment">/* Version of boot_args structure */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                virtBase;                       <span class="comment">/* Virtual base of memory */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                physBase;                       <span class="comment">/* Physical base of memory */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                memSize;                        <span class="comment">/* Size of memory */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                topOfKernelData;        <span class="comment">/* Highest physical address used in kernel data area */</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">XNU_Boot_Video</span>   <span class="title">Video</span>;</span>                          <span class="comment">/* Video Information */</span></span><br><span class="line">	<span class="keyword">uint32_t</span>                machineType;            <span class="comment">/* Machine Type */</span></span><br><span class="line">	<span class="keyword">void</span>                    *deviceTreeP;           <span class="comment">/* Base of flattened device tree */</span></span><br><span class="line">	<span class="keyword">uint32_t</span>                deviceTreeLength;       <span class="comment">/* Length of flattened tree */</span></span><br><span class="line">	<span class="keyword">char</span>                    CommandLine[<span class="number">256</span>];  <span class="comment">/* Passed in command line */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                bootFlags;              <span class="comment">/* Additional flags specified by the bootloader */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                memSizeActual;          <span class="comment">/* Actual size of memory */</span></span><br><span class="line">&#125; boot_args;</span><br></pre></td></tr></table></figure>
<p>Exactly what we need! And</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span></span></span><br><span class="line"><span class="function"><span class="title">PE_init_platform</span><span class="params">(<span class="keyword">boolean_t</span> vm_initialized, <span class="keyword">void</span> *args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	DTEntry         entry;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span>    size;</span><br><span class="line">	<span class="keyword">void</span> * <span class="keyword">const</span>    *prop;</span><br><span class="line">	boot_args      *boot_args_ptr = (boot_args *) args;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (PE_state.initialized == FALSE) &#123;</span><br><span class="line">		page_protection_type = ml_page_protection_type();</span><br><span class="line">		PE_state.initialized = TRUE;</span><br><span class="line">		PE_state.bootArgs = boot_args_ptr;</span><br><span class="line">		PE_state.deviceTreeHead = boot_args_ptr-&gt;deviceTreeP;</span><br><span class="line">		PE_state.deviceTreeSize = boot_args_ptr-&gt;deviceTreeLength;</span><br><span class="line">		PE_state.video.v_baseAddr = boot_args_ptr-&gt;Video.v_baseAddr;</span><br><span class="line">		PE_state.video.v_rowBytes = boot_args_ptr-&gt;Video.v_rowBytes;</span><br><span class="line">		PE_state.video.v_width = boot_args_ptr-&gt;Video.v_width;</span><br><span class="line">		PE_state.video.v_height = boot_args_ptr-&gt;Video.v_height;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>With <a target="_blank" rel="noopener" href="https://github.com/KpwnZ/Def1nit3lyN0tAJa1lbr3akTool">Def1nit3lyN0tAJa1lbr3akTool</a> we have kernel memory reading and writing primitives. Now we can dump the devicetree from a real iPhone X!</p>
<p>Def1nit3lyN0tAJa1lbr3akTool has libkrw installed, so we can use it with Python ctypes to access kernel memory</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">libkrw = CDLL(<span class="string">&#x27;/var/jb/usr/lib/libkrw.0.dylib&#x27;</span>)</span><br><span class="line">kread = libkrw.kread</span><br><span class="line">kread.argtypes = [c_uint64, c_void_p, c_uint64]</span><br><span class="line">data = c_uint64(<span class="number">0</span>)</span><br><span class="line">kread(<span class="number">0x4141414141414141</span>, byref(data), <span class="number">8</span>)</span><br></pre></td></tr></table></figure>
<p>then dump the devicetree</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">iPhone:~ root# hexdump -C -n 128 ./dtdump</span><br><span class="line">00000000  15 00 00 00 11 00 00 00  72 65 67 75 6c 61 74 6f  |........regulato|</span><br><span class="line">00000010  72 79 2d 6d 6f 64 65 6c  2d 6e 75 6d 62 65 72 00  |ry-model-number.|</span><br><span class="line">00000020  00 00 00 00 00 00 00 00  20 00 00 00 41 31 39 30  |........ ...A190|</span><br><span class="line">00000030  35 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |5...............|</span><br><span class="line">00000040  00 00 00 00 00 00 00 00  00 00 00 00 23 61 64 64  |............#add|</span><br><span class="line">00000050  72 65 73 73 2d 63 65 6c  6c 73 00 00 00 00 00 00  |ress-cells......|</span><br><span class="line">00000060  00 00 00 00 00 00 00 00  00 00 00 00 04 00 00 00  |................|</span><br><span class="line">00000070  02 00 00 00 41 41 50 4c  2c 70 68 61 6e 64 6c 65  |....AAPL,phandle|</span><br><span class="line">00000080</span><br><span class="line">iPhone:~ root#</span><br></pre></td></tr></table></figure>
<h2 id="Trust-me">Trust me</h2>
<p>We need to load trustcache, simply download it from ipsw and load it. Then add the address and size to devicetree and the kernel should be happy enough.</p>
<h2 id="Trapped-in-the-loop">Trapped in the loop</h2>
<p>Now kernel stuck at</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">AppleSSE::start called</span><br><span class="line">AppleSSE::start returning, result = 1</span><br><span class="line">AppleSEPKeyStore:321:0: starting (BUILT: Oct 30 2020 00:31:23)</span><br><span class="line">AppleSEPKeyStore:545:0: _sep_enabled = 1</span><br><span class="line">AppleCredentialManager: start: called, instance = &lt;ptr&gt;.</span><br><span class="line">ACMRM: _publishIOResource: AppleUSBRestrictedModeTimeout = 259200.</span><br><span class="line">AppleCredentialManager: start: initializing power management, instance = &lt;ptr&gt;.</span><br><span class="line">AppleCredentialManager: start: started, instance = &lt;ptr&gt;.</span><br><span class="line">AppleCredentialManager: start: returning, result = true, instance = &lt;ptr&gt;.</span><br><span class="line">AppleInterruptController::start: Num Shared Timestamps == 16</span><br><span class="line">virtual bool AppleARMLightEmUp::start(IOService *): starting...</span><br></pre></td></tr></table></figure>
<p>Trace it block by block, we found that it’s stuck at</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">__text:FFFFFFF007FDB7F4                 SUB             SP, SP, #0x50 ; Rd = Op1 - Op2</span><br><span class="line">__text:FFFFFFF007FDB7F8                 STP             X24, X23, [SP,#0x40+var_30] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB7FC                 STP             X22, X21, [SP,#0x40+var_20] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB800                 STP             X20, X19, [SP,#0x40+var_10] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB804                 STP             X29, X30, [SP,#0x40+var_s0] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB808                 ADD             X29, SP, #0x40 ; Rd = Op1 + Op2</span><br><span class="line">__text:FFFFFFF007FDB80C                 STR             XZR, [SP,#0x40+var_38] ; Store to Memory</span><br><span class="line">__text:FFFFFFF007FDB810                 CBZ             X0, loc_FFFFFFF007FDB884 ; Compare and Branch on Zero</span><br><span class="line">__text:FFFFFFF007FDB814                 MOV             X19, X2 ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007FDB818                 MOV             X21, X1 ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007FDB81C                 MOV             X20, X0 ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007FDB820                 STR             XZR, [SP,#0x40+var_38] ; Store to Memory</span><br><span class="line">__text:FFFFFFF007FDB824                 ADRP            X22, #qword_FFFFFFF009352CA0@PAGE ; Address of Page</span><br><span class="line">__text:FFFFFFF007FDB828                 LDR             X0, [X22,#qword_FFFFFFF009352CA0@PAGEOFF] ; Load from Memory</span><br><span class="line">__text:FFFFFFF007FDB82C                 BL              sub_FFFFFFF007FC6200 ; Branch with Link</span><br><span class="line">__text:FFFFFFF007FDB830                 CBZ             X19, loc_FFFFFFF007FDB844 ; Compare and Branch on Zero</span><br><span class="line">__text:FFFFFFF007FDB834                 ADR             X8, sub_FFFFFFF007FDB9C4 ; Load address</span><br><span class="line">__text:FFFFFFF007FDB838                 NOP                     ; No Operation</span><br><span class="line">__text:FFFFFFF007FDB83C                 ADD             X9, SP, #0x40+var_38 ; Rd = Op1 + Op2</span><br><span class="line">__text:FFFFFFF007FDB840                 STP             X8, X9, [X19,#0x10] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB844</span><br></pre></td></tr></table></figure>
<p>the function is called by</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_FFFFFFF008330408</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  OSDictionary *v0; <span class="comment">// x20</span></span><br><span class="line">  __int64 v1; <span class="comment">// x19</span></span><br><span class="line">  __int64 v2; <span class="comment">// x0</span></span><br><span class="line"></span><br><span class="line">  v0 = IOService::resourceMatching(<span class="string">&quot;IORTC&quot;</span>, <span class="number">0LL</span>);</span><br><span class="line">  v1 = sub_FFFFFFF00834FFC4(v0, <span class="number">0x6FC23AC00</span>uLL, <span class="number">0LL</span>);</span><br><span class="line">  v2 = (v0-&gt;vtable-&gt;OSObject.release_1)(v0);</span><br><span class="line">  <span class="keyword">if</span> ( v1 )</span><br><span class="line">    v2 = (*(*v1 + <span class="number">40LL</span>))(v1);</span><br><span class="line">  <span class="keyword">return</span> sub_FFFFFFF007D5A4D4(v2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>We don’t have that yet, so simply patch it to return after entering the function.</p>
<h2 id="Shell-we-dance">Shell we dance?</h2>
<p>Now we can boot userland and launch bash but we can not input anything.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Thu Jan  1 00:00:00 1970 localhost com.apple.xpc.launchd[1] (com.apple.xpc.launchd.domain.system) &lt;Error&gt;: Failed to bootstrap path: path = /AppleInternal/Library/LaunchDaemons, error = 2: No such file or directory</span><br><span class="line">Thu Jan  1 00:00:00 1970 localhost com.apple.xpc.launchd[1] (com.apple.xpc.launchd.domain.system) &lt;Notice&gt;: exiting bootstrap mode</span><br><span class="line">Thu Jan  1 00:00:00 1970 localhost com.apple.xpc.launchd[1] (com.apple.xpc.launchd.domain.system) &lt;Notice&gt;: exiting ondemand mode</span><br><span class="line">bash-5.0#         </span><br></pre></td></tr></table></figure>
<p>after some debugging we can find that the FIQ handler was never called. That means there might be something wrong with our timer. Comparing the kernel of iOS 13 and iOS 14, I notice that</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__text:FFFFFFF007D05C00 loc_FFFFFFF007D05C00                    ; CODE XREF: sub_FFFFFFF007D05AB4+130↑j</span><br><span class="line">__text:FFFFFFF007D05C00                 MRS             X9, #0, c14, c1, #0</span><br><span class="line">__text:FFFFFFF007D05C04                 MOV             W10, #0xD</span><br><span class="line">__text:FFFFFFF007D05C08                 BFI             W10, W8, #4, #0x1C</span><br><span class="line">__text:FFFFFFF007D05C0C                 ORR             X8, X9, X10</span><br><span class="line">__text:FFFFFFF007D05C10                 MSR             #0, c14, c1, #0, X8</span><br><span class="line">__text:FFFFFFF007D05C14                 MOV             W8, #1</span><br><span class="line">__text:FFFFFFF007D05C18                 MSR             #3, c14, c2, #1, X8</span><br></pre></td></tr></table></figure>
<p>iOS 13 enables the physical timer while in iOS 14</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__text:FFFFFFF007B6708C                 STP             X9, XZR, [X8,#0x58] ; Store Pair</span><br><span class="line">__text:FFFFFFF007B67090                 MOV             W8, #1  ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007B67094                 MSR             #3, c14, c3, #1, X8 ; Transfer Register to PSR</span><br><span class="line">__text:FFFFFFF007B67098                 MOV             W8, #2  ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007B6709C                 MSR             #3, c14, c2, #1, X8 ; Transfer Register to PSR</span><br></pre></td></tr></table></figure>
<p>It enables the virtual timer, thus</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qdev_connect_gpio_out(cpudev, GTIMER_VIRT, qdev_get_gpio_in(cpudev, ARM_CPU_FIQ));</span><br></pre></td></tr></table></figure>
<p>that is all we need! And we can unpatch the <code>IORTC</code> hack. Now we have an interactive shell!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">bash-5.0# uname -a</span><br><span class="line">Darwin localhost 20.1.0 Darwin Kernel Version 20.1.0: Fri Oct 30 00:34:17 PDT 2020; root:xnu-7195.42.3~1/RELEASE_ARM64_T8015 iPhone10,3 arm64 D22AP Darwin</span><br><span class="line">bash-5.0# sw_vers</span><br><span class="line">ProductName:    iPhone OS</span><br><span class="line">ProductVersion: 14.2</span><br><span class="line">BuildVersion:   18B92</span><br><span class="line">bash-5.0# id</span><br><span class="line">uid=0(root) gid=0(wheel) groups=0(wheel)</span><br><span class="line">bash-5.0#</span><br></pre></td></tr></table></figure>
<h2 id="Conclusion">Conclusion</h2>
<p>Ah, time to add iOS 16 support.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">KpwnZ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/">https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/iOS/">iOS</a><a class="post-meta__tags" href="/tags/QEMU/">QEMU</a><a class="post-meta__tags" href="/tags/Security/">Security</a></div><div class="post_share"><div class="social-share" data-image="https://source.unsplash.com/featured/?landscape,tech,life" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/12/30/2023/"><img class="next-cover" src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">鼠鼠一事无成之2023</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2022/12/22/CVE-2022-46702-Remember-to-Clean-Up-the-Memory/" title="CVE-2022-46702: Remember to Clean Up the Memory"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-22</div><div class="title">CVE-2022-46702: Remember to Clean Up the Memory</div></div></a></div><div><a href="/2022/02/01/Voucher-Port-and-Message-Exploit-CVE-2019-6225-on-macOS/" title="Voucher, Port and Message: Exploit CVE-2019-6225 on macOS"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-01</div><div class="title">Voucher, Port and Message: Exploit CVE-2019-6225 on macOS</div></div></a></div><div><a href="/2023/10/23/iOS-Userland-Exploitation-pwn1OS-in-N1CTF/" title="From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-23</div><div class="title">From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF</div></div></a></div><div><a href="/2023/04/25/CVE-2020-11102-Escape-from-the-Earth/" title="CVE-2020-11102: Escape from the Earth"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-25</div><div class="title">CVE-2020-11102: Escape from the Earth</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/22996989?s=400&amp;u=470b81ce0dd0fd2e15880f564e1bef0ba9655225&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">KpwnZ</div><div class="author-info__description">~ shit post ~</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">18</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">19</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/KpwnZ"><i class="fab fa-github"></i><span>GitHub</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Boot Newer iOS with QEMU Step by Step</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#First-attempt"><span class="toc-number">1.1.</span> <span class="toc-text">First attempt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trust-me"><span class="toc-number">1.2.</span> <span class="toc-text">Trust me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trapped-in-the-loop"><span class="toc-number">1.3.</span> <span class="toc-text">Trapped in the loop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-we-dance"><span class="toc-number">1.4.</span> <span class="toc-text">Shell we dance?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.5.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/" title="Boot Newer iOS with QEMU Step by Step"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Boot Newer iOS with QEMU Step by Step"/></a><div class="content"><a class="title" href="/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/" title="Boot Newer iOS with QEMU Step by Step">Boot Newer iOS with QEMU Step by Step</a><time datetime="2024-03-09T18:30:27.000Z" title="Created 2024-03-09 10:30:27">2024-03-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/30/2023/" title="鼠鼠一事无成之2023"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="鼠鼠一事无成之2023"/></a><div class="content"><a class="title" href="/2023/12/30/2023/" title="鼠鼠一事无成之2023">鼠鼠一事无成之2023</a><time datetime="2023-12-31T06:15:03.000Z" title="Created 2023-12-30 22:15:03">2023-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/23/iOS-Userland-Exploitation-pwn1OS-in-N1CTF/" title="From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF"/></a><div class="content"><a class="title" href="/2023/10/23/iOS-Userland-Exploitation-pwn1OS-in-N1CTF/" title="From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF">From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF</a><time datetime="2023-10-23T08:55:58.000Z" title="Created 2023-10-23 01:55:58">2023-10-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/08/SDCTF-2023-Writeup/" title="SDCTF 2023 Writeup"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SDCTF 2023 Writeup"/></a><div class="content"><a class="title" href="/2023/05/08/SDCTF-2023-Writeup/" title="SDCTF 2023 Writeup">SDCTF 2023 Writeup</a><time datetime="2023-05-08T19:41:03.000Z" title="Created 2023-05-08 12:41:03">2023-05-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/25/CVE-2020-11102-Escape-from-the-Earth/" title="CVE-2020-11102: Escape from the Earth"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2020-11102: Escape from the Earth"/></a><div class="content"><a class="title" href="/2023/04/25/CVE-2020-11102-Escape-from-the-Earth/" title="CVE-2020-11102: Escape from the Earth">CVE-2020-11102: Escape from the Earth</a><time datetime="2023-04-25T07:50:54.000Z" title="Created 2023-04-25 00:50:54">2023-04-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By KpwnZ</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>