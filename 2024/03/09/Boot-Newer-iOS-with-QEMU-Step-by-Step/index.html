<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Boot Newer iOS with QEMU Step by Step I decided to update my QEMU fork to support newer iOS versions for security research and some CTFs. Just note down how I did it here. First attempt Build D22-QEMU">
<meta property="og:type" content="article">
<meta property="og:title" content="Boot Newer iOS with QEMU Step by Step">
<meta property="og:url" content="https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/index.html">
<meta property="og:site_name">
<meta property="og:description" content="Boot Newer iOS with QEMU Step by Step I decided to update my QEMU fork to support newer iOS versions for security research and some CTFs. Just note down how I did it here. First attempt Build D22-QEMU">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-03-09T18:30:27.000Z">
<meta property="article:modified_time" content="2024-03-12T03:20:53.626Z">
<meta property="article:author" content="Xia0o0o0o">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="QEMU">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="../../../../https:/avatars.githubusercontent.com/u/22996989?s=400&amp;u=18dec832f23e8e1d9f7097245cd5b955990979b8&amp;v=4">
        
      
      
        
          <link rel="icon" type="image/png" href="../../../../https:/avatars.githubusercontent.com/u/22996989?s=400&amp;u=18dec832f23e8e1d9f7097245cd5b955990979b8&amp;v=4" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="../../../../https:/avatars.githubusercontent.com/u/22996989?s=400&amp;u=18dec832f23e8e1d9f7097245cd5b955990979b8&amp;v=4">
        
      
    
    <!-- title -->
    <title>Boot Newer iOS with QEMU Step by Step</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="../../../../css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="atom.xml" title="" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
      <!--
           -->
        <li>
          <span style="display: flex; align-items: center;">
            <title>
              Home
            </title>
            <svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 6.56062L8.00001 2.06062L3.50001 6.56062V13.5L6.00001 13.5V11C6.00001 9.89539 6.89544 8.99996 8.00001 8.99996C9.10458 8.99996 10 9.89539 10 11V13.5L12.5 13.5V6.56062ZM13.78 5.71933L8.70711 0.646409C8.31659 0.255886 7.68342 0.255883 7.2929 0.646409L2.21987 5.71944C2.21974 5.71957 2.21961 5.7197 2.21949 5.71982L0.469676 7.46963L-0.0606537 7.99996L1.00001 9.06062L1.53034 8.53029L2.00001 8.06062V14.25V15H2.75001L6.00001 15H7.50001H8.50001H10L13.25 15H14V14.25V8.06062L14.4697 8.53029L15 9.06062L16.0607 7.99996L15.5303 7.46963L13.7806 5.71993C13.7804 5.71973 13.7802 5.71953 13.78 5.71933ZM8.50001 11V13.5H7.50001V11C7.50001 10.7238 7.72386 10.5 8.00001 10.5C8.27615 10.5 8.50001 10.7238 8.50001 11Z" fill="currentColor"></path></svg>
              <a style="padding-left: 9px;" href="../../../../index.html">
                Home
              </a>
          </span>
        </li>
        <!--
           -->
        <li>
          <span style="display: flex; align-items: center;">
            <title>
              Writing
            </title>
            <svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path clip-rule="evenodd" d="M4.25 0C3.00736 0 2 1.00736 2 2.25V11V11.25V11.5C2 12.5252 2.61705 13.4062 3.5 13.792V11.5V11.25V11C3.5 10.4477 3.94772 10 4.5 10H12.5V11.2305V12.5H10.5V14H12.5H14V12.5V11.2305V10V8.5V0.75V0H13.25H4.25ZM12.5 8.5V1.5H4.25C3.83579 1.5 3.5 1.83579 3.5 2.25V8.70802C3.80623 8.57422 4.14445 8.5 4.5 8.5H12.5ZM5.5 11.5C5.22386 11.5 5 11.7239 5 12V16L7 14.75L9 16V12C9 11.7239 8.77614 11.5 8.5 11.5H5.5Z" fill="currentColor" fill-rule="evenodd"></path></svg>
              <a style="padding-left: 9px;" href="../../../../archives/">
                Writing
              </a>
          </span>
        </li>
        <!--
           -->
        <li>
          <span style="display: flex; align-items: center;">
            <title>
              Projects
            </title>
            <svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.80808 4.44191L2.25003 4.88386L3.13391 3.99997L2.69196 3.55803L1.63391 2.49997L2.69197 1.44191L3.13391 0.999972L2.25003 0.116089L1.80808 0.558031L0.484858 1.88126C0.143149 2.22296 0.143149 2.77698 0.484859 3.11869L1.80808 4.44191ZM12 0.999972H11.25V2.49997H12H13.5V11.75C13.5 12.7165 12.7165 13.5 11.75 13.5H4.25002C3.28353 13.5 2.50003 12.7165 2.50003 11.75V6.99997V6.24997H1.00003V6.99997V11.75C1.00003 13.5449 2.4551 15 4.25002 15H11.75C13.545 15 15 13.5449 15 11.75V1.74997V0.999972H14.25H12ZM7.75003 4.88386L8.19197 4.44191L9.51519 3.11869C9.8569 2.77698 9.8569 2.22296 9.51519 1.88126L8.19196 0.55803L7.75002 0.116089L6.86614 0.999973L7.30808 1.44191L8.36614 2.49997L7.30809 3.55803L6.86615 3.99997L7.75003 4.88386ZM4.13155 3.89688L4.02847 4.51535L5.26541 4.7215L5.36848 4.10303L5.86848 1.10303L5.97156 0.484566L4.73462 0.278409L4.63155 0.896878L4.13155 3.89688Z" fill="currentColor"></path></svg>
              <a style="padding-left: 9px;" href="../../../../https:/github.com/KpwnZ">
                Projects
              </a>
          </span>
        </li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="../../../../2023/12/30/2023/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&text=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&is_video=false&description=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Boot Newer iOS with QEMU Step by Step&body=Check out this article: https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&name=Boot Newer iOS with QEMU Step by Step&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&t=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Boot Newer iOS with QEMU Step by Step</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#First-attempt"><span class="toc-number">1.1.</span> <span class="toc-text">First attempt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trust-me"><span class="toc-number">1.2.</span> <span class="toc-text">Trust me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trapped-in-the-loop"><span class="toc-number">1.3.</span> <span class="toc-text">Trapped in the loop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-we-dance"><span class="toc-number">1.4.</span> <span class="toc-text">Shell we dance?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.5.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Boot Newer iOS with QEMU Step by Step
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Xia0o0o0o</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-03-09T18:30:27.000Z" class="dt-published" itemprop="datePublished">2024-03-09</time>
        
      
    </div>


      

      
    <div class="article-tag" style="text-decoration: none;">
        <i class="fa-solid fa-tag"></i>
        <a class="tag-category" href="../../../../tags/QEMU/" rel="tag">QEMU</a> <a class="tag-category" href="../../../../tags/Security/" rel="tag">Security</a> <a class="tag-category" href="../../../../tags/iOS/" rel="tag">iOS</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1>Boot Newer iOS with QEMU Step by Step</h1>
<p>I decided to update <a target="_blank" rel="noopener" href="https://github.com/KpwnZ/d22-qemu">my QEMU fork</a> to support newer iOS versions for security research and <s>some CTFs</s>. Just note down how I did it here.</p>
<h2 id="First-attempt">First attempt</h2>
<p>Build D22-QEMU and load the iOS 14 kernel and we got</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">./qemu-system-aarch64 -M d22-idevice,kernelcache=&#x27;ios14/kcache.patched&#x27;,devicetree=&#x27;ios14/dtre.bin&#x27;,ramdisk=&#x27;ios14/rdsk.dmg&#x27;,trustcache=&#x27;ios14/trustcache&#x27;,bootargs=&#x27;debug=0x14e kextlog=0xffff cpus=1 rd=md0 serial=2&#x27;,ram-size=&#x27;1073741824&#x27; \</span><br><span class="line">-d unimp,int -cpu max -serial mon:stdio -D ./qemu.log</span><br><span class="line">iBoot version: D22-QEMU loader</span><br><span class="line">Darwin Image4 Validator Version 3.1.0: Fri Oct 30 00:14:28 PDT 2020; root:AppleImage4-106.40.12~2113/AppleImage4/RELEASE_ARM64</span><br><span class="line">panic(cpu 0 caller 0xfffffff0080af660): Kernel data abort. at pc 0xfffffff008024f64, lr 0xfffffff008024f54 (saved state: 0xffffffe80260b5f0)</span><br><span class="line">	  x0: 0xffffffe4cddbcbf0  x1:  0xfffffff00932cbe8  x2:  0x0000000000000000  x3:  0xffffffe80260b960</span><br><span class="line">	  x4: 0x0000000000000007  x5:  0x0000000000000073  x6:  0x829f5c9941fe80a8  x7:  0x0000000000000630</span><br><span class="line">	  x8: 0x0000000000000000  x9:  0xfffffff00774ada8  x10: 0xfffffff00774adb8  x11: 0x0000000000000001</span><br><span class="line">	  x12: 0x00000000004a0000 x13: 0x00000000ffdfffff  x14: 0x0000000000000001  x15: 0x0003ffffff933789</span><br><span class="line">	  x16: 0x0000000000004000 x17: 0xfffffff0073ac824  x18: 0xfffffff0080a1000  x19: 0xffffffe4cde8ba00</span><br><span class="line">	  x20: 0xffffffe4cdf70680 x21: 0x0000000000000000  x22: 0xffffffe80260bab0  x23: 0x0000000000000009</span><br><span class="line">	  x24: 0xfffffff0081bdee8 x25: 0xfffffff009300de8  x26: 0x0000000000000009  x27: 0x0000000000000009</span><br><span class="line">	  x28: 0xfffffff009300de8 fp:  0xffffffe80260b9c0  lr:  0xfffffff008024f54  sp:  0xffffffe80260b940</span><br><span class="line">	  pc:  0xfffffff008024f64 cpsr: 0x60400204         esr: 0x96000005          far: 0x0000000000000000</span><br></pre></td></tr></table></figure>
<p>Well although it paniked, it’s a good start at least the serial port is still working. Then let’s check the pc address</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__text:FFFFFFF008024F64 loc_FFFFFFF008024F64                    ; CODE XREF: sub_FFFFFFF008024D88+26C↓j</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F64                                         ; sub_FFFFFFF008024D88+278↓j ...</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F64                 LDR             X8, [X21] ; Load from Memory</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F68                 LDR             X8, [X8,#0x138] ; Load from Memory</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F6C                 MOV             X0, X21 ; Rd = Op2</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F70                 MOV             X1, X20 ; Rd = Op2</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F74                 BLR             X8      ; Branch and Link Register</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F78                 MOV             X20, X0 ; Rd = Op2</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F7C                 CBZ             X0, loc_FFFFFFF008024F90 ; Compare and Branch on Zero</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F80                 LDR             X8, [X20] ; Load from Memory</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F84                 LDR             X8, [X8,#0x20] ; Load from Memory</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F88                 MOV             X0, X20 ; Rd = Op2</span><br><span class="line">__TEXT_EXEC:__text:FFFFFFF008024F8C                 BLR             X8      ; Branch and Link Register</span><br></pre></td></tr></table></figure>
<p>After some reversing, I found that that it’s nvram variable loading routine. But we didn’t load any nvram variable! In iOS 14, nvram data can be loaded to devicetree by iBoot</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">result = sub_FFFFFFF007FCE6F8(<span class="string">&quot;/chosen&quot;</span>, qword_FFFFFFF009301760, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line"><span class="keyword">if</span> ( result )</span><br><span class="line">&#123;</span><br><span class="line">  v3 = result;</span><br><span class="line">  v4 = (*(__int64 (__fastcall **)(__int64, <span class="keyword">const</span> <span class="keyword">char</span> *))(*(_QWORD *)result + <span class="number">328LL</span>))(result, <span class="string">&quot;nvram-proxy-data&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>I am just too lazy to reverse the nvram stuff, but since it’s loaded to devicetree, we can dump it from a real device! Now let’s try to find the memory address of devicetree. Luckily, we have</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">xnu_boot_args</span> &#123;</span></span><br><span class="line">	<span class="keyword">uint16_t</span>                Revision;                       <span class="comment">/* Revision of boot_args structure */</span></span><br><span class="line">	<span class="keyword">uint16_t</span>                Version;                        <span class="comment">/* Version of boot_args structure */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                virtBase;                       <span class="comment">/* Virtual base of memory */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                physBase;                       <span class="comment">/* Physical base of memory */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                memSize;                        <span class="comment">/* Size of memory */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                topOfKernelData;        <span class="comment">/* Highest physical address used in kernel data area */</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">XNU_Boot_Video</span>   <span class="title">Video</span>;</span>                          <span class="comment">/* Video Information */</span></span><br><span class="line">	<span class="keyword">uint32_t</span>                machineType;            <span class="comment">/* Machine Type */</span></span><br><span class="line">	<span class="keyword">void</span>                    *deviceTreeP;           <span class="comment">/* Base of flattened device tree */</span></span><br><span class="line">	<span class="keyword">uint32_t</span>                deviceTreeLength;       <span class="comment">/* Length of flattened tree */</span></span><br><span class="line">	<span class="keyword">char</span>                    CommandLine[<span class="number">256</span>];  <span class="comment">/* Passed in command line */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                bootFlags;              <span class="comment">/* Additional flags specified by the bootloader */</span></span><br><span class="line">	<span class="keyword">uint64_t</span>                memSizeActual;          <span class="comment">/* Actual size of memory */</span></span><br><span class="line">&#125; boot_args;</span><br></pre></td></tr></table></figure>
<p>Exactly what we need! And</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span></span></span><br><span class="line"><span class="function"><span class="title">PE_init_platform</span><span class="params">(<span class="keyword">boolean_t</span> vm_initialized, <span class="keyword">void</span> *args)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	DTEntry         entry;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span>    size;</span><br><span class="line">	<span class="keyword">void</span> * <span class="keyword">const</span>    *prop;</span><br><span class="line">	boot_args      *boot_args_ptr = (boot_args *) args;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (PE_state.initialized == FALSE) &#123;</span><br><span class="line">		page_protection_type = ml_page_protection_type();</span><br><span class="line">		PE_state.initialized = TRUE;</span><br><span class="line">		PE_state.bootArgs = boot_args_ptr;</span><br><span class="line">		PE_state.deviceTreeHead = boot_args_ptr-&gt;deviceTreeP;</span><br><span class="line">		PE_state.deviceTreeSize = boot_args_ptr-&gt;deviceTreeLength;</span><br><span class="line">		PE_state.video.v_baseAddr = boot_args_ptr-&gt;Video.v_baseAddr;</span><br><span class="line">		PE_state.video.v_rowBytes = boot_args_ptr-&gt;Video.v_rowBytes;</span><br><span class="line">		PE_state.video.v_width = boot_args_ptr-&gt;Video.v_width;</span><br><span class="line">		PE_state.video.v_height = boot_args_ptr-&gt;Video.v_height;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>With <a target="_blank" rel="noopener" href="https://github.com/KpwnZ/Def1nit3lyN0tAJa1lbr3akTool">Def1nit3lyN0tAJa1lbr3akTool</a> we have kernel memory reading and writing primitives. Now we can dump the devicetree from a real iPhone X!</p>
<p>Def1nit3lyN0tAJa1lbr3akTool has libkrw installed, so we can use it with Python ctypes to access kernel memory</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">libkrw = CDLL(<span class="string">&#x27;/var/jb/usr/lib/libkrw.0.dylib&#x27;</span>)</span><br><span class="line">kread = libkrw.kread</span><br><span class="line">kread.argtypes = [c_uint64, c_void_p, c_uint64]</span><br><span class="line">data = c_uint64(<span class="number">0</span>)</span><br><span class="line">kread(<span class="number">0x4141414141414141</span>, byref(data), <span class="number">8</span>)</span><br></pre></td></tr></table></figure>
<p>then dump the devicetree</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">iPhone:~ root# hexdump -C -n 128 ./dtdump</span><br><span class="line">00000000  15 00 00 00 11 00 00 00  72 65 67 75 6c 61 74 6f  |........regulato|</span><br><span class="line">00000010  72 79 2d 6d 6f 64 65 6c  2d 6e 75 6d 62 65 72 00  |ry-model-number.|</span><br><span class="line">00000020  00 00 00 00 00 00 00 00  20 00 00 00 41 31 39 30  |........ ...A190|</span><br><span class="line">00000030  35 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |5...............|</span><br><span class="line">00000040  00 00 00 00 00 00 00 00  00 00 00 00 23 61 64 64  |............#add|</span><br><span class="line">00000050  72 65 73 73 2d 63 65 6c  6c 73 00 00 00 00 00 00  |ress-cells......|</span><br><span class="line">00000060  00 00 00 00 00 00 00 00  00 00 00 00 04 00 00 00  |................|</span><br><span class="line">00000070  02 00 00 00 41 41 50 4c  2c 70 68 61 6e 64 6c 65  |....AAPL,phandle|</span><br><span class="line">00000080</span><br><span class="line">iPhone:~ root#</span><br></pre></td></tr></table></figure>
<h2 id="Trust-me">Trust me</h2>
<p>We need to load trustcache, simply download it from ipsw and load it. Then add the address and size to devicetree and the kernel should be happy enough.</p>
<h2 id="Trapped-in-the-loop">Trapped in the loop</h2>
<p>Now kernel stuck at</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">AppleSSE::start called</span><br><span class="line">AppleSSE::start returning, result = 1</span><br><span class="line">AppleSEPKeyStore:321:0: starting (BUILT: Oct 30 2020 00:31:23)</span><br><span class="line">AppleSEPKeyStore:545:0: _sep_enabled = 1</span><br><span class="line">AppleCredentialManager: start: called, instance = &lt;ptr&gt;.</span><br><span class="line">ACMRM: _publishIOResource: AppleUSBRestrictedModeTimeout = 259200.</span><br><span class="line">AppleCredentialManager: start: initializing power management, instance = &lt;ptr&gt;.</span><br><span class="line">AppleCredentialManager: start: started, instance = &lt;ptr&gt;.</span><br><span class="line">AppleCredentialManager: start: returning, result = true, instance = &lt;ptr&gt;.</span><br><span class="line">AppleInterruptController::start: Num Shared Timestamps == 16</span><br><span class="line">virtual bool AppleARMLightEmUp::start(IOService *): starting...</span><br></pre></td></tr></table></figure>
<p>Trace it block by block, we found that it’s stuck at</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">__text:FFFFFFF007FDB7F4                 SUB             SP, SP, #0x50 ; Rd = Op1 - Op2</span><br><span class="line">__text:FFFFFFF007FDB7F8                 STP             X24, X23, [SP,#0x40+var_30] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB7FC                 STP             X22, X21, [SP,#0x40+var_20] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB800                 STP             X20, X19, [SP,#0x40+var_10] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB804                 STP             X29, X30, [SP,#0x40+var_s0] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB808                 ADD             X29, SP, #0x40 ; Rd = Op1 + Op2</span><br><span class="line">__text:FFFFFFF007FDB80C                 STR             XZR, [SP,#0x40+var_38] ; Store to Memory</span><br><span class="line">__text:FFFFFFF007FDB810                 CBZ             X0, loc_FFFFFFF007FDB884 ; Compare and Branch on Zero</span><br><span class="line">__text:FFFFFFF007FDB814                 MOV             X19, X2 ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007FDB818                 MOV             X21, X1 ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007FDB81C                 MOV             X20, X0 ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007FDB820                 STR             XZR, [SP,#0x40+var_38] ; Store to Memory</span><br><span class="line">__text:FFFFFFF007FDB824                 ADRP            X22, #qword_FFFFFFF009352CA0@PAGE ; Address of Page</span><br><span class="line">__text:FFFFFFF007FDB828                 LDR             X0, [X22,#qword_FFFFFFF009352CA0@PAGEOFF] ; Load from Memory</span><br><span class="line">__text:FFFFFFF007FDB82C                 BL              sub_FFFFFFF007FC6200 ; Branch with Link</span><br><span class="line">__text:FFFFFFF007FDB830                 CBZ             X19, loc_FFFFFFF007FDB844 ; Compare and Branch on Zero</span><br><span class="line">__text:FFFFFFF007FDB834                 ADR             X8, sub_FFFFFFF007FDB9C4 ; Load address</span><br><span class="line">__text:FFFFFFF007FDB838                 NOP                     ; No Operation</span><br><span class="line">__text:FFFFFFF007FDB83C                 ADD             X9, SP, #0x40+var_38 ; Rd = Op1 + Op2</span><br><span class="line">__text:FFFFFFF007FDB840                 STP             X8, X9, [X19,#0x10] ; Store Pair</span><br><span class="line">__text:FFFFFFF007FDB844</span><br></pre></td></tr></table></figure>
<p>the function is called by</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_FFFFFFF008330408</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  OSDictionary *v0; <span class="comment">// x20</span></span><br><span class="line">  __int64 v1; <span class="comment">// x19</span></span><br><span class="line">  __int64 v2; <span class="comment">// x0</span></span><br><span class="line"></span><br><span class="line">  v0 = IOService::resourceMatching(<span class="string">&quot;IORTC&quot;</span>, <span class="number">0LL</span>);</span><br><span class="line">  v1 = sub_FFFFFFF00834FFC4(v0, <span class="number">0x6FC23AC00</span>uLL, <span class="number">0LL</span>);</span><br><span class="line">  v2 = (v0-&gt;vtable-&gt;OSObject.release_1)(v0);</span><br><span class="line">  <span class="keyword">if</span> ( v1 )</span><br><span class="line">    v2 = (*(*v1 + <span class="number">40LL</span>))(v1);</span><br><span class="line">  <span class="keyword">return</span> sub_FFFFFFF007D5A4D4(v2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>We don’t have that yet, so simply patch it to return after entering the function.</p>
<h2 id="Shell-we-dance">Shell we dance?</h2>
<p>Now we can boot userland and launch bash but we can not input anything.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Thu Jan  1 00:00:00 1970 localhost com.apple.xpc.launchd[1] (com.apple.xpc.launchd.domain.system) &lt;Error&gt;: Failed to bootstrap path: path = /AppleInternal/Library/LaunchDaemons, error = 2: No such file or directory</span><br><span class="line">Thu Jan  1 00:00:00 1970 localhost com.apple.xpc.launchd[1] (com.apple.xpc.launchd.domain.system) &lt;Notice&gt;: exiting bootstrap mode</span><br><span class="line">Thu Jan  1 00:00:00 1970 localhost com.apple.xpc.launchd[1] (com.apple.xpc.launchd.domain.system) &lt;Notice&gt;: exiting ondemand mode</span><br><span class="line">bash-5.0#         </span><br></pre></td></tr></table></figure>
<p>after some debugging we can find that the FIQ handler was never called. That means there might be something wrong with our timer. Comparing the kernel of iOS 13 and iOS 14, I notice that</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__text:FFFFFFF007D05C00 loc_FFFFFFF007D05C00                    ; CODE XREF: sub_FFFFFFF007D05AB4+130↑j</span><br><span class="line">__text:FFFFFFF007D05C00                 MRS             X9, #0, c14, c1, #0</span><br><span class="line">__text:FFFFFFF007D05C04                 MOV             W10, #0xD</span><br><span class="line">__text:FFFFFFF007D05C08                 BFI             W10, W8, #4, #0x1C</span><br><span class="line">__text:FFFFFFF007D05C0C                 ORR             X8, X9, X10</span><br><span class="line">__text:FFFFFFF007D05C10                 MSR             #0, c14, c1, #0, X8</span><br><span class="line">__text:FFFFFFF007D05C14                 MOV             W8, #1</span><br><span class="line">__text:FFFFFFF007D05C18                 MSR             #3, c14, c2, #1, X8</span><br></pre></td></tr></table></figure>
<p>iOS 13 enables the physical timer while in iOS 14</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__text:FFFFFFF007B6708C                 STP             X9, XZR, [X8,#0x58] ; Store Pair</span><br><span class="line">__text:FFFFFFF007B67090                 MOV             W8, #1  ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007B67094                 MSR             #3, c14, c3, #1, X8 ; Transfer Register to PSR</span><br><span class="line">__text:FFFFFFF007B67098                 MOV             W8, #2  ; Rd = Op2</span><br><span class="line">__text:FFFFFFF007B6709C                 MSR             #3, c14, c2, #1, X8 ; Transfer Register to PSR</span><br></pre></td></tr></table></figure>
<p>It enables the virtual timer, thus</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qdev_connect_gpio_out(cpudev, GTIMER_VIRT, qdev_get_gpio_in(cpudev, ARM_CPU_FIQ));</span><br></pre></td></tr></table></figure>
<p>that is all we need! And we can unpatch the <code>IORTC</code> hack. Now we have an interactive shell!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">bash-5.0# uname -a</span><br><span class="line">Darwin localhost 20.1.0 Darwin Kernel Version 20.1.0: Fri Oct 30 00:34:17 PDT 2020; root:xnu-7195.42.3~1/RELEASE_ARM64_T8015 iPhone10,3 arm64 D22AP Darwin</span><br><span class="line">bash-5.0# sw_vers</span><br><span class="line">ProductName:    iPhone OS</span><br><span class="line">ProductVersion: 14.2</span><br><span class="line">BuildVersion:   18B92</span><br><span class="line">bash-5.0# id</span><br><span class="line">uid=0(root) gid=0(wheel) groups=0(wheel)</span><br><span class="line">bash-5.0#</span><br></pre></td></tr></table></figure>
<h2 id="Conclusion">Conclusion</h2>
<p>Ah, time to add iOS 16 support.</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
      <!--
     --><li>
        <span style="display: flex; align-items: center;">
          <svg class="index-item-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="margin-right: 10px; color: white; width: 21px; ">
            <title>Home</title>
            <path d="<svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 6.56062L8.00001 2.06062L3.50001 6.56062V13.5L6.00001 13.5V11C6.00001 9.89539 6.89544 8.99996 8.00001 8.99996C9.10458 8.99996 10 9.89539 10 11V13.5L12.5 13.5V6.56062ZM13.78 5.71933L8.70711 0.646409C8.31659 0.255886 7.68342 0.255883 7.2929 0.646409L2.21987 5.71944C2.21974 5.71957 2.21961 5.7197 2.21949 5.71982L0.469676 7.46963L-0.0606537 7.99996L1.00001 9.06062L1.53034 8.53029L2.00001 8.06062V14.25V15H2.75001L6.00001 15H7.50001H8.50001H10L13.25 15H14V14.25V8.06062L14.4697 8.53029L15 9.06062L16.0607 7.99996L15.5303 7.46963L13.7806 5.71993C13.7804 5.71973 13.7802 5.71953 13.78 5.71933ZM8.50001 11V13.5H7.50001V11C7.50001 10.7238 7.72386 10.5 8.00001 10.5C8.27615 10.5 8.50001 10.7238 8.50001 11Z" fill="currentColor"></path></svg>" fill="white"/>
          </svg>
          <a href="../../../../index.html">Home</a>
        </span>
      </li><!--
     --><li>
        <span style="display: flex; align-items: center;">
          <svg class="index-item-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="margin-right: 10px; color: white; width: 21px; ">
            <title>Writing</title>
            <path d="<svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path clip-rule="evenodd" d="M4.25 0C3.00736 0 2 1.00736 2 2.25V11V11.25V11.5C2 12.5252 2.61705 13.4062 3.5 13.792V11.5V11.25V11C3.5 10.4477 3.94772 10 4.5 10H12.5V11.2305V12.5H10.5V14H12.5H14V12.5V11.2305V10V8.5V0.75V0H13.25H4.25ZM12.5 8.5V1.5H4.25C3.83579 1.5 3.5 1.83579 3.5 2.25V8.70802C3.80623 8.57422 4.14445 8.5 4.5 8.5H12.5ZM5.5 11.5C5.22386 11.5 5 11.7239 5 12V16L7 14.75L9 16V12C9 11.7239 8.77614 11.5 8.5 11.5H5.5Z" fill="currentColor" fill-rule="evenodd"></path></svg>" fill="white"/>
          </svg>
          <a href="../../../../archives/">Writing</a>
        </span>
      </li><!--
     --><li>
        <span style="display: flex; align-items: center;">
          <svg class="index-item-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="margin-right: 10px; color: white; width: 21px; ">
            <title>Projects</title>
            <path d="<svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.80808 4.44191L2.25003 4.88386L3.13391 3.99997L2.69196 3.55803L1.63391 2.49997L2.69197 1.44191L3.13391 0.999972L2.25003 0.116089L1.80808 0.558031L0.484858 1.88126C0.143149 2.22296 0.143149 2.77698 0.484859 3.11869L1.80808 4.44191ZM12 0.999972H11.25V2.49997H12H13.5V11.75C13.5 12.7165 12.7165 13.5 11.75 13.5H4.25002C3.28353 13.5 2.50003 12.7165 2.50003 11.75V6.99997V6.24997H1.00003V6.99997V11.75C1.00003 13.5449 2.4551 15 4.25002 15H11.75C13.545 15 15 13.5449 15 11.75V1.74997V0.999972H14.25H12ZM7.75003 4.88386L8.19197 4.44191L9.51519 3.11869C9.8569 2.77698 9.8569 2.22296 9.51519 1.88126L8.19196 0.55803L7.75002 0.116089L6.86614 0.999973L7.30808 1.44191L8.36614 2.49997L7.30809 3.55803L6.86615 3.99997L7.75003 4.88386ZM4.13155 3.89688L4.02847 4.51535L5.26541 4.7215L5.36848 4.10303L5.86848 1.10303L5.97156 0.484566L4.73462 0.278409L4.63155 0.896878L4.13155 3.89688Z" fill="currentColor"></path></svg>" fill="white"/>
          </svg>
          <a href="../../../../https:/github.com/KpwnZ">Projects</a>
        </span>
      </li>
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Boot Newer iOS with QEMU Step by Step</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#First-attempt"><span class="toc-number">1.1.</span> <span class="toc-text">First attempt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trust-me"><span class="toc-number">1.2.</span> <span class="toc-text">Trust me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trapped-in-the-loop"><span class="toc-number">1.3.</span> <span class="toc-text">Trapped in the loop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-we-dance"><span class="toc-number">1.4.</span> <span class="toc-text">Shell we dance?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.5.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&text=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&is_video=false&description=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Boot Newer iOS with QEMU Step by Step&body=Check out this article: https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&title=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&name=Boot Newer iOS with QEMU Step by Step&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://kpwnz.github.io/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/&t=Boot Newer iOS with QEMU Step by Step"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    Xia0o0o0o
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="../../../../index.html">Home</a></li><!--
     --><!--
       --><li><a href="../../../../archives/">Writing</a></li><!--
     --><!--
       --><li><a href="../../../../https:/github.com/KpwnZ">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="../../../../js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
